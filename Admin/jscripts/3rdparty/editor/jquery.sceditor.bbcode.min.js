
!function(g,f,j){var i={html:'<!DOCTYPE html><html><head><style>.ie * {min-height: auto !important}</style><meta http-equiv="Content-Type" content="text/html;charset={charset}" /><link rel="stylesheet" type="text/css" href="{style}" /></head><body contenteditable="true" {spellcheck}></body></html>',toolbarButton:'<a class="sceditor-button sceditor-button-{name}" data-sceditor-command="{name}" unselectable="on"><div unselectable="on"></div></a>',emoticon:'<img src="{url}" data-sceditor-emoticon="{key}" alt="{key}" title="{tooltip}" />',fontOpt:'<a class="sceditor-font-option" href="#" data-font="{font}"><font face="{font}">{font}</font></a>',sizeOpt:'<a class="sceditor-fontsize-option" data-size="{size}" href="#"><font size="{size}">{size}</font></a>',pastetext:'<div><label for="txt">{label}</label> <textarea cols="20" rows="7" id="txt"></textarea></div><div><input type="button" class="button" value="{insert}" /></div>',table:'<div><label for="rows">{rows}</label><input type="text" id="rows" value="2" /></div><div><label for="cols">{cols}</label><input type="text" id="cols" value="2" /></div><div><input type="button" class="button" value="{insert}" /></div>',image:'<h2>Insert an Image</h2><div class="content"><div><label>{url}</label><div class="text"><input type="text" id="image" placeholder="http://" /></span></div><div><label>{width}</label><span class="text"><input type="text" id="width" size="2" /></div><label>{height}</label><div class="text"><input type="text" id="height" size="2" /></div><div class="text-center"><span class="sceditor-btn"><input class="verde button" type="button" value="{insert}" /></span></div></div>',email:'<div><label for="email">{label}</label> <input type="text" id="email" /></div><div><input type="button" class="button" value="{insert}" /></div>',link:'<h2>Insert A Link</h2><div class="content"><div><label>{url}</label><div class="text"><input type="text" id="link" placeholder="http://" /></div><div class="text-center"><span class="sceditor-btn"><input class="verde button" type="button" value="{ins}" /></span></div></div>',youtubeMenu:'<h2>Insert a Video</h2><div class="content"><div><label>{label}</label><div class="text"><input type="text" id="link" placeholder="URL del video" /></div><div class="text-center"><span class="sceditor-btn"><input type="button" class="verde button" value="{insert}" /></span></div></div>',youtube:'<iframe width="560" height="315" src="http://www.youtube.com/embed/{id}?wmode=opaque" data-youtube-id="{id}" frameborder="0" allowfullscreen></iframe>'},h=function(a,l,k){var d=i[a];return g.each(l,function(e,c){d=d.replace(new RegExp("\\{"+e+"\\}","g"),c);}),k&&(d=g(d)),d;};g.sceditor=function(a8,a7){var a6,a5,a4,a3,a2,a1,a0,aZ,aY,aX,aW,aV,aU,aT,aS,aR,aQ,aO,aN,aL,aC,aA,az,ay,ax,aw,av,au,at,ar,aq,ap,ao,an,am,al,ak,aj,ai,ah,ag,af,ae,ad,aa,e,aH,ba,aB,a9,aI,aD,a,aJ,aE=this,b=a8.get?a8.get(0):a8,aK=g(b),aF=[],c=[],aM=[],aG=[],ac={},aP=[];aE.commands=g.extend(!0,{},a7.commands||g.sceditor.commands),aE.opts=a7=g.extend({},g.sceditor.defaultOptions,a7),aC=function(){aK.data("sceditor",aE),g.each(a7,function(d,l){g.isPlainObject(l)&&(a7[d]=g.extend(!0,{},l));}),a7.locale&&"en"!==a7.locale&&av(),a6=g('<div class="sceditor-container" />').insertAfter(aK).css("z-index",a7.zIndex),g.sceditor.ie&&a6.addClass("ie ie"+g.sceditor.ie),aN=!!aK.attr("required"),aK.removeAttr("required"),aw(),ao(),au(),ax(),aq(),at(),ar(),g.sceditor.isWysiwygSupported||aE.toggleSourceMode();var k=function(){g(f).unbind("load",k),a7.autofocus&&aI(),a7.autoExpand&&aE.expandToContent(),ad();};g(f).load(k),j.readyState&&"complete"===j.readyState&&k(),e(),aT.call("ready");},aw=function(){var d=a7.plugins;d=d?d.toString().split(","):[],aT=new g.sceditor.PluginManager(aE),g.each(d,function(k,l){aT.register(g.trim(l));});},av=function(){var d;g.sceditor.locale[a7.locale]?aW=g.sceditor.locale[a7.locale]:(d=a7.locale.split("-"),g.sceditor.locale[d[0]]&&(aW=g.sceditor.locale[d[0]])),aW&&aW.dateFormat&&(a7.dateFormat=aW.dateFormat);},ax=function(){var l,k;a0=g("<textarea></textarea>").hide(),a4=g('<iframe frameborder="0"></iframe>'),a7.spellcheck||a0.attr("spellcheck","false"),"https:"===f.location.protocol&&a4.attr("src","javascript:false"),a6.append(a4).append(a0),a3=a4[0],aZ=a0[0],aE.width(a7.width||aK.width()),aE.height(a7.height||aK.height()),l=an(),l.open(),l.write(h("html",{spellcheck:a7.spellcheck?"":'spellcheck="false"',charset:a7.charset,style:a7.style})),l.close(),a1=g(l),a2=g(l.body),aE.readOnly(!!a7.readOnly),g.sceditor.ie&&a1.find("html").addClass("ie ie"+g.sceditor.ie),(g.sceditor.ios||g.sceditor.ie)&&(a2.height("100%"),g.sceditor.ie||a2.bind("touchend",aE.focus)),aV=new g.sceditor.rangeHelper(a3.contentWindow),aE.val(aK.hide().val()),k=aK.attr("tabindex"),a0.attr("tabindex",k),a4.attr("tabindex",k);},at=function(){a7.autoUpdate&&(a2.bind("blur",aE.updateOriginal),a0.bind("blur",aE.updateOriginal)),null===a7.rtl&&(a7.rtl="rtl"===a0.css("direction")),aE.rtl(!!a7.rtl),a7.autoExpand&&a1.bind("keyup",aE.expandToContent),a7.resizeEnabled&&ap(),a6.attr("id",a7.id),aE.emoticons(a7.emoticonsEnabled);},ar=function(){g(j).click(ae),g(b.form).bind("reset",ah).submit(aE.updateOriginal),g(f).bind("resize orientationChanged",ad),a2.keypress(ai).keydown(ak).keydown(aj).keyup(ba).bind("paste",am).bind(g.sceditor.ie?"selectionchange":"keyup focus blur contextmenu mouseup touchend click",aB).bind("keydown keyup keypress focus blur contextmenu",af),a7.emoticonsCompat&&f.getSelection&&a2.keyup(a),a0.bind("keydown keyup keypress focus blur contextmenu",af).keydown(ak),a1.keypress(ai).mousedown(ag).bind(g.sceditor.ie?"selectionchange":"focus blur contextmenu mouseup click",aB).bind("beforedeactivate keyup",ay).keyup(ba).focus(function(){aX=null;}),a6.bind("selectionchanged",a9).bind("selectionchanged",e).bind("selectionchanged",af).bind("nodechanged",af);},au=function(){var k,n,m=(a7.toolbarExclude||"").split(","),l=a7.toolbar.split("|");a5=g('<div class="sceditor-toolbar" unselectable="on" />'),g.each(l,function(o,d){k=g('<div class="sceditor-group" />'),g.each(d.split(","),function(q,p){!aE.commands[p]||g.inArray(p,m)>-1||(n=h("toolbarButton",{name:p,dispName:aE._(aE.commands[p].tooltip||p)},!0),n.data("sceditor-txtmode",!!aE.commands[p].txtExec),n.data("sceditor-wysiwygmode",!!aE.commands[p].exec),n.click(function(){var r=g(this);return r.hasClass("disabled")||az(r,aE.commands[p]),e(),!1;}),aE.commands[p].tooltip&&n.attr("title",aE._(aE.commands[p].tooltip)),aE.commands[p].exec||n.addClass("disabled"),aE.commands[p].shortcut&&aE.addShortcut(aE.commands[p].shortcut,p),k.append(n));}),k[0].firstChild&&a5.append(k);}),g(a7.toolbarContainer||a6).append(a5);},aq=function(){g.each(aE.commands,function(d,k){k.keyPress&&aF.push(k.keyPress),k.forceNewLineAfter&&g.isArray(k.forceNewLineAfter)&&(aM=g.merge(aM,k.forceNewLineAfter)),k.state?aG.push({name:d,state:k.state}):"string"==typeof k.exec&&aG.push({name:d,state:k.exec});}),ba();},ap=function(){var H,G,F,E,D,C,B=g('<div class="sceditor-grip" />'),A=g('<div class="sceditor-resize-cover" />'),z=0,y=0,x=0,w=0,v=a6.width(),K=a6.height(),J=!1,I=aE.rtl();H=a7.resizeMinHeight||K/1.5,G=a7.resizeMaxHeight||2.5*K,F=a7.resizeMinWidth||v/1.25,E=a7.resizeMaxWidth||1.25*v,D=function(m){"touchmove"===m.type&&(m=f.event);var l=w+(m.pageY-y),d=I?x-(m.pageX-z):x+(m.pageX-z);E>0&&d>E&&(d=E),G>0&&l>G&&(l=G),(!a7.resizeWidth||F>d||E>0&&d>E)&&(d=!1),(!a7.resizeHeight||H>l||G>0&&l>G)&&(l=!1),(d||l)&&(aE.dimensions(d,l),g.sceditor.ie<7&&a6.height(l)),m.preventDefault();},C=function(d){J&&(J=!1,A.hide(),a6.removeClass("resizing").height("auto"),g(j).unbind("touchmove mousemove",D),g(j).unbind("touchend mouseup",C),d.preventDefault());},a6.append(B),a6.append(A.hide()),B.bind("touchstart mousedown",function(k){"touchstart"===k.type&&(k=f.event),z=k.pageX,y=k.pageY,x=a6.width(),w=a6.height(),J=!0,a6.addClass("resizing"),A.show(),g(j).bind("touchmove mousemove",D),g(j).bind("touchend mouseup",C),g.sceditor.ie<7&&a6.height(w),k.preventDefault();});},ao=function(){var k,m=a7.emoticons,l=a7.emoticonsRoot;g.isPlainObject(m)&&a7.emoticonsEnabled&&g.each(m,function(n,d){g.each(d,function(o,p){l&&(p={url:l+(p.url||p),tooltip:p.tooltip||o},m[n][o]=p),k=j.createElement("img"),k.src=p.url||p,c.push(k);});});},aI=function(){var k,p,o,n=a1[0],m=a2[0],l=!!a7.autofocusEnd;if(a6.is(":visible")){if(aE.sourceMode()){o=aZ.value.length,aZ.setSelectionRange?aZ.setSelectionRange(o,o):aZ.createTextRange&&(k=aZ.createTextRange(),k.moveEnd("character",o),k.moveStart("character",o),aV.selectRange(k));}else{if(g.sceditor.dom.removeWhiteSpace(m),l){for((p=m.lastChild)||a2.append(p=n.createElement("div"));p.lastChild;){p=p.lastChild,/br/i.test(p.nodeName)&&p.previousSibling&&(p=p.previousSibling);}}else{p=m.firstChild;}n.createRange?(k=n.createRange(),/br/i.test(p.nodeName)?k.setStartBefore(p):k.selectNodeContents(p),k.collapse(!1)):(k=m.createTextRange(),k.moveToElementText(3!==p.nodeType?p:p.parentNode),k.collapse(!1)),aV.selectRange(k),l&&(a1.scrollTop(m.scrollHeight),a2.scrollTop(m.scrollHeight));}aE.focus();}},aE.readOnly=function(d){return"boolean"!=typeof d?"readonly"===a0.attr("readonly"):(a2[0].contentEditable=!d,d?a0.attr("readonly","readonly"):a0.removeAttr("readonly"),aa(d),this);},aE.rtl=function(k){var d=k?"rtl":"ltr";return"boolean"!=typeof k?"rtl"===a0.attr("dir"):(a2.attr("dir",d),a0.attr("dir",d),a6.removeClass("rtl").removeClass("ltr").addClass(d),this);},aa=function(d){var k=aE.inSourceMode();a5.find(".sceditor-button").removeClass("disabled").each(function(){var l=g(this);d===!0||k&&!l.data("sceditor-txtmode")?l.addClass("disabled"):k||l.data("sceditor-wysiwygmode")||l.addClass("disabled");});},aE.width=function(k,d){return k||0===k?(aE.dimensions(k,null,d),this):a6.width();},aE.dimensions=function(k,n,m){var l=g.sceditor.ie<8||j.documentMode<8?2:0;return k=k||0===k?k:!1,n=n||0===n?n:!1,k===!1&&n===!1?{width:aE.width(),height:aE.height()}:("undefined"==typeof a4.data("outerWidthOffset")&&aE.updateStyleCache(),k!==!1&&(m!==!1&&(a7.width=k),n===!1&&(n=a6.height(),m=!1),a6.width(k),k&&k.toString().indexOf("%")>-1&&(k=a6.width()),a4.width(k-a4.data("outerWidthOffset")),a0.width(k-a0.data("outerWidthOffset")),g.sceditor.ios&&a2&&a2.width(k-a4.data("outerWidthOffset")-(a2.outerWidth(!0)-a2.width()))),n!==!1&&(m!==!1&&(a7.height=n),n&&n.toString().indexOf("%")>-1&&(n=a6.height(n).height(),a6.height("auto")),n-=a7.toolbarContainer?0:a5.outerHeight(!0),a4.height(n-a4.data("outerHeightOffset")),a0.height(n-l-a0.data("outerHeightOffset"))),this);},aE.updateStyleCache=function(){a4.data("outerWidthOffset",a4.outerWidth(!0)-a4.width()),a0.data("outerWidthOffset",a0.outerWidth(!0)-a0.width()),a4.data("outerHeightOffset",a4.outerHeight(!0)-a4.height()),a0.data("outerHeightOffset",a0.outerHeight(!0)-a0.height());},aE.height=function(k,d){return k||0===k?(aE.dimensions(null,k,d),this):a6.height();},aE.maximize=function(d){return"undefined"==typeof d?a6.is(".sceditor-maximize"):(d=!!d,g.sceditor.ie<7&&g("html, body").toggleClass("sceditor-maximize",d),a6.toggleClass("sceditor-maximize",d),aE.width(d?"100%":a7.width,!1),aE.height(d?"100%":a7.height,!1),this);},aE.expandToContent=function(l){var k=a6.height(),o=a2[0].scrollHeight||a1[0].documentElement.scrollHeight,n=k-a4.height(),m=a7.resizeMaxHeight||2*(a7.height||aK.height());o+=n,l!==!0&&o>m&&(o=m),o>k&&aE.height(o);},aE.destroy=function(){aT.destroy(),aV=null,aX=null,aT=null,g(j).unbind("click",ae),g(f).unbind("resize orientationChanged",ad),g(b.form).unbind("reset",ah).unbind("submit",aE.updateOriginal),a2.unbind(),a1.unbind().find("*").remove(),a0.unbind().remove(),a5.remove(),a6.unbind().find("*").unbind().remove(),a6.remove(),aK.removeData("sceditor").removeData("sceditorbbcode").show(),aN&&aK.attr("required","required");},aE.createDropDown=function(k,p,o,n){var m,l=aY&&aY.is(".sceditor-"+p);aE.closeDropDown(),l||(n!==!1&&g(o).find(":not(input,textarea)").filter(function(){return 1===this.nodeType;}).attr("unselectable","on"),m={top:k.offset().top,left:k.offset().left,marginTop:k.outerHeight()},g.extend(m,a7.dropDownCss),aY=g('<div class="sceditor-dropdown sceditor-'+p+'" />').css(m).append(o).appendTo(g("body")).hide().animate({opacity:"toggle",marginTop:"+=15px"},400,"easeInOutQuint").click(function(d){d.stopPropagation();}));},ae=function(d){3!==d.which&&aE.closeDropDown();},am=function(l){var k,r,q=a2[0],p=a1[0],o=0,n=j.createElement("div"),m=p.createDocumentFragment();if(a7.disablePasting){return !1;}if(a7.enablePasteFiltering){if(aV.saveRange(),j.body.appendChild(n),l&&l.clipboardData&&l.clipboardData.getData&&((k=l.clipboardData.getData("text/html"))||(k=l.clipboardData.getData("text/plain")))){return n.innerHTML=k,al(q,n),!1;}for(;q.firstChild;){m.appendChild(q.firstChild);}return r=function(s,d){if(s.childNodes.length>0){for(;s.firstChild;){d.appendChild(s.firstChild);}for(;m.firstChild;){s.appendChild(m.firstChild);}al(s,d);}else{if(o>25){for(;m.firstChild;){s.appendChild(m.firstChild);}return aV.restoreRange(),void 0;}++o,setTimeout(function(){r(s,d);},20);}},r(q,n),aE.focus(),!0;}},al=function(k,m){g.sceditor.dom.fixNesting(m);var l=m.innerHTML;aT.hasHandler("toSource")&&(l=aT.callOnlyFirst("toSource",l,g(m))),m.parentNode.removeChild(m),aT.hasHandler("toWysiwyg")&&(l=aT.callOnlyFirst("toWysiwyg",l,!0)),aV.restoreRange(),aE.wysiwygEditorInsertHtml(l,null,!0);},aE.closeDropDown=function(d){aY&&(aY.unbind().animate({opacity:"toggle",marginTop:"-=15px"},400,"easeInOutQuint",function(){this.remove();}),aY=null),d===!0&&aE.focus();},an=function(){return a3.contentDocument?a3.contentDocument:a3.contentWindow&&a3.contentWindow.document?a3.contentWindow.document:a3.document?a3.document:null;},aE.wysiwygEditorInsertHtml=function(k,p,o){var n,m,l='<span id="sceditor-cursor">&nbsp;</span>';aE.focus(),(o||!g(aR).is("code")&&0===g(aR).parents("code").length)&&(p?p+=l:k+=l,aV.insertHTML(k,p),m=a2.find("#sceditor-cursor"),n=m.offset().top+2*m.outerHeight(!0)-a4.height(),m.remove(),a1.scrollTop(n),a2.scrollTop(n),aV.saveRange(),aA(a2[0]),aV.restoreRange(),ba());},aE.wysiwygEditorInsertText=function(d,k){aE.wysiwygEditorInsertHtml(g.sceditor.escapeEntities(d),g.sceditor.escapeEntities(k));},aE.insertText=function(k,d){return aE.inSourceMode()?aE.sourceEditorInsertText(k,d):aE.wysiwygEditorInsertText(k,d),this;},aE.sourceEditorInsertText=function(l,k){var q,p,o,n,m;m=aZ.scrollTop,aZ.focus(),"undefined"!=typeof aZ.selectionStart?(p=aZ.selectionStart,o=aZ.selectionEnd,n=l.length,k&&(l+=aZ.value.substring(p,o)+k),aZ.value=aZ.value.substring(0,p)+l+aZ.value.substring(o,aZ.value.length),aZ.selectionStart=p+l.length-(k?k.length:0),aZ.selectionEnd=aZ.selectionStart):"undefined"!=typeof j.selection.createRange?(q=j.selection.createRange(),k&&(l+=q.text+k),q.text=l,k&&q.moveEnd("character",0-k.length),q.moveStart("character",q.End-q.Start),q.select()):aZ.value+=l+k,aZ.scrollTop=m,aZ.focus();},aE.getRangeHelper=function(){return aV;},aE.val=function(k,d){return"string"==typeof k?(aE.inSourceMode()?aE.setSourceEditorValue(k):(d!==!1&&aT.hasHandler("toWysiwyg")&&(k=aT.callOnlyFirst("toWysiwyg",k)),aE.setWysiwygEditorValue(k)),this):aE.inSourceMode()?aE.getSourceEditorValue(!1):aE.getWysiwygEditorValue();},aE.insert=function(k,q,p,o,n){if(aE.inSourceMode()){aE.sourceEditorInsertText(k,q);}else{if(q){var m=aE.getRangeHelper().selectedHtml(),l=g("<div>").appendTo(g("body")).hide().html(m);p!==!1&&aT.hasHandler("toSource")&&(m=aT.callOnlyFirst("toSource",m,l)),l.remove(),k+=m+q;}p!==!1&&aT.hasHandler("toWysiwyg")&&(k=aT.callOnlyFirst("toWysiwyg",k,!0)),p!==!1&&n===!0&&(k=k.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")),aE.wysiwygEditorInsertHtml(k);}return this;},aE.getWysiwygEditorValue=function(k){var n,m,l=aV.hasSelection();return l?aV.saveRange():aX&&aX.getBookmark&&(m=aX.getBookmark()),g.sceditor.dom.fixNesting(a2[0]),n=a2.html(),k!==!1&&aT.hasHandler("toSource")&&(n=aT.callOnlyFirst("toSource",n,a2)),l?(aV.restoreRange(),aX=null):m&&(aX.moveToBookmark(m),aX=null),n;},aE.getBody=function(){return a2;},aE.getContentAreaContainer=function(){return a4;},aE.getSourceEditorValue=function(k){var d=a0.val();return k!==!1&&aT.hasHandler("toWysiwyg")&&(d=aT.callOnlyFirst("toWysiwyg",d)),d;},aE.setWysiwygEditorValue=function(d){d||(d="<p>"+(g.sceditor.ie?"":"<br />")+"</p>"),a2[0].innerHTML=d,aA(a2[0]),ba();},aE.setSourceEditorValue=function(d){a0.val(d);},aE.updateOriginal=function(){aK.val(aE.val());},aA=function(k){if(a7.emoticonsEnabled&&!g(k).parents("code").length){var p=k.ownerDocument,o=[],n=[],m=g.extend({},a7.emoticons.more,a7.emoticons.dropdown,a7.emoticons.hidden);g.each(m,function(d){a7.emoticonsCompat&&(n[d]=new RegExp("(>|^|\\s| | | | |&nbsp;)"+g.sceditor.regexEscape(d)+"(\\s|$|<| | | | |&nbsp;)")),o.push(d);}),function l(A){for(A=A.firstChild;null!=A;){var z,y,x,w,v,u,t,s=A.parentNode,d=A.nodeValue;if(3!==A.nodeType){g(A).is("code")||l(A);}else{if(d){for(v=o.length;v--;){y=o[v],t=a7.emoticonsCompat?d.search(n[y]):d.indexOf(y),t>-1&&(u=A.nextSibling,x=m[y],z=d.substr(t).split(y),d=d.substr(0,t)+z.shift(),A.nodeValue=d,w=g.sceditor.dom.parseHTML(h("emoticon",{key:y,url:x.url||x,tooltip:x.tooltip||y}),p),s.insertBefore(w[0],u),s.insertBefore(p.createTextNode(z.join(y)),u));}}}A=A.nextSibling;}}(k),a7.emoticonsCompat&&(aP=a2.find("img[data-sceditor-emoticon]"));}},aE.inSourceMode=function(){return a6.hasClass("sourceMode");},aE.sourceMode=function(d){return"boolean"!=typeof d?aE.inSourceMode():((aE.inSourceMode()&&!d||!aE.inSourceMode()&&d)&&aE.toggleSourceMode(),this);},aE.toggleSourceMode=function(){(g.sceditor.isWysiwygSupported||!aE.inSourceMode())&&(aE.blur(),aE.inSourceMode()?aE.setWysiwygEditorValue(aE.getSourceEditorValue()):aE.setSourceEditorValue(aE.getWysiwygEditorValue()),aX=null,a0.toggle(),a4.toggle(),aE.inSourceMode()?a6.removeClass("sourceMode").addClass("wysiwygMode"):a6.removeClass("wysiwygMode").addClass("sourceMode"),aa(),e());},aH=function(){return aZ.focus(),null!=aZ.selectionStart?aZ.value.substring(aZ.selectionStart,aZ.selectionEnd):j.selection.createRange?j.selection.createRange().text:void 0;},az=function(d,k){return aE.inSourceMode()?(k.txtExec&&(g.isArray(k.txtExec)?aE.sourceEditorInsertText.apply(aE,k.txtExec):k.txtExec.call(aE,d,aH())),void 0):(k.exec&&(g.isFunction(k.exec)?k.exec.call(aE,d):aE.execCommand(k.exec,k.hasOwnProperty("execParam")?k.execParam:null)),void 0);},ay=function(){g.sceditor.ie&&(aX=aV.selectedRange());},aE.execCommand=function(k,o){var n=!1,m=g(aV.parentNode());if(aE.focus(),!m.is("code")&&0===m.parents("code").length){try{n=a1[0].execCommand(k,!1,o);}catch(l){}!n&&aE.commands[k]&&aE.commands[k].errorMessage&&alert(aE._(aE.commands[k].errorMessage));}},aB=function(){var d=function(){aV&&!aV.compare(aQ)&&(aQ=aV.cloneSelected(),a6.trigger(g.Event("selectionchanged"))),aO=!1;};aO||(aO=!0,g.sceditor.ie?d():setTimeout(d,100));},a9=function(){var d,k=aV.parentNode();aS!==k&&(d=aS,aS=k,aR=aV.getFirstBlockParent(k),a6.trigger(g.Event("nodechanged",{oldNode:d,newNode:aS})));},aE.currentNode=function(){return aS;},aE.currentBlockNode=function(){return aR;},e=function(u){var t,s,r,q,p,o=a1[0],n=aG.length,m=aE.sourceMode();if(aE.sourceMode()||aE.readOnly()){a5.find(".sceditor-button").removeClass("active");}else{for(p=u?u.newNode:aV.parentNode(),r=aV.getFirstBlockParent(p);n--;){if(t=0,s=aG[n],q=a5.find(".sceditor-button-"+s.name),m&&!q.data("sceditor-txtmode")){q.addClass("disabled");}else{if(m||q.data("sceditor-wysiwygmode")){if("string"==typeof s.state){try{t=o.queryCommandEnabled(s.state)?0:-1,t>-1&&(t=o.queryCommandState(s.state)?1:0);}catch(l){}}else{t=s.state.call(aE,p,r);}0>t?q.addClass("disabled"):q.removeClass("disabled"),t>0?q.addClass("active"):q.removeClass("active");}else{q.addClass("disabled");}}}}},ai=function(k){var m,l=aF.length;if(aE.closeDropDown(),m=g(aS),13===k.which&&(m.is("code,blockquote,pre")||0!==m.parents("code,blockquote,pre").length)){return aX=null,aE.wysiwygEditorInsertHtml("<br />",null,!0),!1;}if(!m.is("code")&&0===m.parents("code").length){for(;l--;){aF[l].call(aE,k,a3,a0);}}},ba=function(){var k,m,l;g.sceditor.dom.rTraverse(a2[0],function(d){return k=d.nodeName.toLowerCase(),g.inArray(k,aM)>-1&&(m=!0),3===d.nodeType&&!/^\s*$/.test(d.nodeValue)||"br"===k||g.sceditor.ie&&!d.firstChild&&!g.sceditor.dom.isInline(d,!1)?(m&&(l=a2[0].ownerDocument.createElement("div"),l.className="sceditor-nlf",l.innerHTML=g.sceditor.ie?"":"<br />",a2[0].appendChild(l)),!1):void 0;});},ah=function(){aE.val(aK.val());},ag=function(){aE.closeDropDown(),aX=null;},ad=function(){var k=a7.height,d=a7.width;aE.maximize()?aE.dimensions("100%","100%",!1):(k&&k.toString().indexOf("%")>-1&&aE.height(k),d&&d.toString().indexOf("%")>-1&&aE.width(d));},aE._=function(){var d=arguments;return aW&&aW[d[0]]&&(d[0]=aW[d[0]]),d[0].replace(/\{(\d+)\}/g,function(k,l){return"undefined"!=typeof d[l-0+1]?d[l-0+1]:"{"+l+"}";});},af=function(k){var m,l=g.extend({},k);aT.call(l.type+"Event",k,aE),delete l.type,m=g.Event((k.target===aZ?"scesrc":"scewys")+k.type,l),a6.trigger.apply(a6,[m,aE]),m.isDefaultPrevented()&&k.preventDefault(),m.isImmediatePropagationStopped()&&m.stopImmediatePropagation(),m.isPropagationStopped()&&m.stopPropagation();},aE.bind=function(k,o,n,m){var l=k.length;for(k=k.split(" ");l--;){g.isFunction(o)&&(n||a6.bind("scewys"+k[l],o),m||a6.bind("scesrc"+k[l],o));}return this;},aE.unbind=function(k,o,n,m){var l=k.length;for(k=k.split(" ");l--;){g.isFunction(o)&&(n||a6.unbind("scewys"+k[l],o),m||a6.unbind("scesrc"+k[l],o));}return this;},aE.blur=function(k,m,l){return g.isFunction(k)?aE.bind("blur",k,m,l):aE.sourceMode()?a0.blur():(aU||(aU=g('<input style="position:absolute;width:0;height:0;opacity:0;border:0;padding:0;filter:alpha(opacity=0)" type="text" />').appendTo(a6)),aU.removeAttr("disabled").show().focus().blur().hide().attr("disabled","disabled")),this;},aE.focus=function(k,m,l){return g.isFunction(k)?aE.bind("focus",k,m,l):aE.inSourceMode()?aZ.focus():(a3.contentWindow.focus(),a2[0].focus(),aX&&(aV.selectRange(aX),aX=null)),this;},aE.keyDown=function(k,d,l){return aE.bind("keydown",k,d,l);},aE.keyPress=function(k,d,l){return aE.bind("keypress",k,d,l);},aE.keyUp=function(k,d,l){return aE.bind("keyup",k,d,l);},aE.nodeChanged=function(d){return aE.bind("nodechanged",d,!1,!0);},aE.selectionChanged=function(d){return aE.bind("selectionchanged",d,!1,!0);},aD=function(k){var m=0,l=String.fromCharCode(k.which);if(!g(aR).is("code")&&!g(aR).parents("code").length){return aE.emoticonsCache||(aE.emoticonsCache=[],g.each(g.extend({},a7.emoticons.more,a7.emoticons.dropdown,a7.emoticons.hidden),function(n,d){aE.emoticonsCache[m++]=[n,h("emoticon",{key:n,url:d.url||d,tooltip:d.tooltip||n})];}),aE.emoticonsCache.sort(function(n,d){return n[0].length-d[0].length;}),aE.longestEmoticonCode=aE.emoticonsCache[aE.emoticonsCache.length-1][0].length),aE.getRangeHelper().raplaceKeyword(aE.emoticonsCache,!0,!0,aE.longestEmoticonCode,a7.emoticonsCompat,l)?(a7.emoticonsCompat&&(aP=a2.find("img[data-sceditor-emoticon]")),/^\s$/.test(l)&&a7.emoticonsCompat):void 0;}},a=function(){if(aP.length){var s,r,q,p,o,n,m=aE.currentBlockNode(),l=!1,k=/[^\s\xA0\u2002\u2003\u2009]+/;aP=g.map(aP,function(d){return d&&d.parentNode?g.contains(m,d)?(s=d.previousSibling,r=d.nextSibling,o=s.nodeValue,null===o&&(o=s.innerText||""),s&&k.test(s.nodeValue.slice(-1))||r&&k.test((r.nodeValue||"")[0])?(q=d.parentNode,p=aV.cloneSelected(),n=p.startContainer,o+=g(d).data("sceditor-emoticon"),n===r?l=o.length+p.startOffset:n===m&&m.childNodes[p.startOffset]===r?l=o.length:n===s&&(l=p.startOffset),r&&3===r.nodeType||(r=q.insertBefore(q.ownerDocument.createTextNode(""),r)),r.insertData(0,o),q.removeChild(s),q.removeChild(d),l!==!1&&(p.setStart(r,l),p.collapse(!0),aV.selectRange(p)),null):d):d:null;});}},aE.emoticons=function(d){return d||d===!1?(a7.emoticonsEnabled=d,d?(a2.keypress(aD),aE.sourceMode()||(aV.saveRange(),aA(a2[0]),aP=a2.find("img[data-sceditor-emoticon]"),aV.restoreRange())):(a2.find("img[data-sceditor-emoticon]").replaceWith(function(){return g(this).data("sceditor-emoticon");}),aP=[],a2.unbind("keypress",aD)),this):a7.emoticonsEnabled;},aE.css=function(d){return aL||(aL=g('<style id="#inline" />').appendTo(a1.find("head"))[0]),"string"!=typeof d?aL.styleSheet?aL.styleSheet.cssText:aL.innerHTML:(aL.styleSheet?aL.styleSheet.cssText=d:aL.innerHTML=d,this);},ak=function(l){var k=[],q={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|","[":"{","]":"}"},p={8:"backspace",9:"tab",13:"enter",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",91:"win",92:"win",93:"select",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scrolllock",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},o={109:"-",110:"del",111:"/",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"},n=l.which,m=p[n]||String.fromCharCode(n).toLowerCase();return l.ctrlKey&&k.push("ctrl"),l.altKey&&k.push("alt"),l.shiftKey&&(k.push("shift"),o[n]?m=o[n]:q[m]&&(m=q[m])),m&&(16>n||n>18)&&k.push(m),k=k.join("+"),ac[k]?ac[k].call(aE):void 0;},aE.addShortcut=function(k,d){return k=k.toLowerCase(),ac[k]="string"==typeof d?function(){return az(a5.find(".sceditor-button-"+d),aE.commands[d]),!1;}:d,this;},aE.removeShortcut=function(d){return delete ac[d.toLowerCase()],this;},aj=function(p){var o,n,m,l,k;if(!g.sceditor.ie&&!a7.disableBlockRemove&&8===p.which&&(l=aV.selectedRange())&&(f.getSelection?(o=l.startContainer,n=l.startOffset):(o=l.parentElement(),m=a1[0].selection.createRange(),m.moveToElementText(o),m.setEndPoint("EndToStart",l),n=m.text.length),0===n&&(k=aJ()))){for(;o!==k;){for(;o.previousSibling;){if(o=o.previousSibling,3!==o.nodeType||o.nodeValue){return;}}if(!(o=o.parentNode)){return;}}if(k&&!g(k).is("body")){return aE.clearBlockFormatting(k),!1;}}},aJ=function(){for(var d=aR;!g.sceditor.dom.hasStyling(d);){if(!(d=d.parentNode)||g(d).is("body")){return;}}return d;},aE.clearBlockFormatting=function(d){return d=d||aJ(),!d||g(d).is("body")?this:(aV.saveRange(),aX=null,d.className="",g(d).attr("style",""),g(d).is("p,div")||g.sceditor.dom.convertElement(d,"p"),aV.restoreRange(),this);},aC();},g.sceditor.ie=function(){var b,l=3,k=j.createElement("div"),c=k.getElementsByTagName("i");do{k.innerHTML="<!--[if gt IE "+ ++l+"]><i></i><![endif]-->";}while(c[0]);return j.documentMode&&j.all&&f.atob&&(l=10),4===l&&j.documentMode&&(l=11),l>4?l:b;}(),g.sceditor.ios=/iPhone|iPod|iPad| wosbrowser\//i.test(navigator.userAgent),g.sceditor.isWysiwygSupported=function(){var a,n,m=g('<div contenteditable="true">')[0].contentEditable,l="undefined"!=typeof m&&"inherit"!==m,k=navigator.userAgent;return l?(n=/Opera Mobi|Opera Mini/i.test(k),/Android/i.test(k)&&(n=!0,/Safari/.test(k)&&(a=/Safari\/(\d+)/.exec(k),n=a&&a[1]?a[1]<534:!0)),/ Silk\//i.test(k)&&(a=/AppleWebKit\/(\d+)/.exec(k),n=a&&a[1]?a[1]<534:!0),g.sceditor.ios&&(n=!/OS [5-9](_\d)+ like Mac OS X/i.test(k)),/fennec/i.test(k)&&(n=!1),/OneBrowser/i.test(k)&&(n=!1),"UCWEB"===navigator.vendor&&(n=!1),!n):!1;}(),g.sceditor.regexEscape=function(b){return b.replace(/[\$\?\[\]\.\*\(\)\|\\]/g,"\\$&");},g.sceditor.escapeEntities=function(b){return b?b.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ {2}/g," &nbsp;").replace(/\r\n|\r/g,"\n").replace(/\n/g,"<br />"):b;},g.sceditor.locale={},g.sceditor.commands={bold:{exec:"bold",tooltip:"Bold",shortcut:"ctrl+b"},italic:{exec:"italic",tooltip:"Italic",shortcut:"ctrl+i"},underline:{exec:"underline",tooltip:"Underline",shortcut:"ctrl+u"},strike:{exec:"strikethrough",tooltip:"Strikethrough"},subscript:{exec:"subscript",tooltip:"Subscript"},superscript:{exec:"superscript",tooltip:"Superscript"},left:{exec:"justifyleft",tooltip:"Align left"},center:{exec:"justifycenter",tooltip:"Center"},right:{exec:"justifyright",tooltip:"Align right"},justify:{exec:"justifyfull",tooltip:"Justify"},font:{_dropDown:function(a,o,n){for(var m=a.opts.fonts.split(","),l=g("<div />"),k=function(){return n(g(this).data("font")),a.closeDropDown(!0),!1;},e=0;e<m.length;e++){l.append(h("fontOpt",{font:m[e]},!0).click(k));}a.createDropDown(o,"font-picker",l);},exec:function(a){var d=this;g.sceditor.command.get("font")._dropDown(d,a,function(b){d.execCommand("fontname",b);});},tooltip:"Font Name"},size:{_dropDown:function(a,n,m){for(var l=g("<div />"),k=function(b){m(g(this).data("size")),a.closeDropDown(!0),b.preventDefault();},e=1;7>=e;e++){l.append(h("sizeOpt",{size:e},!0).click(k));}a.createDropDown(n,"fontsize-picker",l);},exec:function(a){var d=this;g.sceditor.command.get("size")._dropDown(d,a,function(b){d.execCommand("fontsize",b);});},tooltip:"Font Size"},color:{_dropDown:function(x,w,v){var u,t,s,r,q={r:255,g:255,b:255},p=g("<div />"),o=x.opts.colors?x.opts.colors.split("|"):new Array(21),n=[],a=g.sceditor.command.get("color");if(!a._htmlCache){for(u=0;u<o.length;++u){for(r=o[u]?o[u].split(","):new Array(21),n.push('<div class="sceditor-color-column">'),t=0;t<r.length;++t){s=r[t]||"#"+q.r.toString(16)+q.g.toString(16)+q.b.toString(16),n.push('<a href="#" class="sceditor-color-option" style="background-color: '+s+'" data-color="'+s+'"></a>'),0===t%5?(q.g-=51,q.b=255):q.b-=51;}n.push("</div>"),0===u%5?(q.r-=51,q.g=255,q.b=255):(q.g=255,q.b=255);}a._htmlCache=n.join("");}p.append(a._htmlCache).find("a").click(function(b){v(g(this).attr("data-color")),x.closeDropDown(!0),b.preventDefault();}),x.createDropDown(w,"color-picker",p);},exec:function(a){var d=this;g.sceditor.command.get("color")._dropDown(d,a,function(b){d.execCommand("forecolor",b);});},tooltip:"Font Color"},removeformat:{exec:"removeformat",tooltip:"Remove Formatting"},cut:{exec:"cut",tooltip:"Cut",errorMessage:"Your browser does not allow the cut command. Please use the keyboard shortcut Ctrl/Cmd-X"},copy:{exec:"copy",tooltip:"Copy",errorMessage:"Your browser does not allow the copy command. Please use the keyboard shortcut Ctrl/Cmd-C"},paste:{exec:"paste",tooltip:"Paste",errorMessage:"Your browser does not allow the paste command. Please use the keyboard shortcut Ctrl/Cmd-V"},pastetext:{exec:function(k){var e,m=this,l=h("pastetext",{label:m._("Paste your text inside the following box:"),insert:m._("Insert")},!0);l.find(".button").click(function(b){e=l.find("#txt").val(),e&&m.wysiwygEditorInsertText(e),m.closeDropDown(!0),b.preventDefault();}),m.createDropDown(k,"pastetext",l);},tooltip:"Paste Text"},bulletlist:{exec:"insertunorderedlist",tooltip:"Bullet list"},orderedlist:{exec:"insertorderedlist",tooltip:"Numbered list"},table:{exec:function(a){var k=this,e=h("table",{rows:k._("Rows:"),cols:k._("Cols:"),insert:k._("Insert")},!0);e.find(".button").click(function(c){var o=e.find("#rows").val()-0,n=e.find("#cols").val()-0,m="<table>";if(!(1>o||1>n)){for(var l=0;o>l;l++){m+="<tr>";for(var d=0;n>d;d++){m+="<td>"+(g.sceditor.ie?"":"<br />")+"</td>";}m+="</tr>";}m+="</table>",k.wysiwygEditorInsertHtml(m),k.closeDropDown(!0),c.preventDefault();}}),k.createDropDown(a,"inserttable",e);},tooltip:"Insert a table"},horizontalrule:{exec:"inserthorizontalrule",tooltip:"Insert a horizontal rule"},code:{forceNewLineAfter:["code"],exec:function(){this.wysiwygEditorInsertHtml("<code>","<br /></code>");},tooltip:"Code"},image:{exec:function(e){var d=this,k=h("image",{url:d._("URL:"),width:d._("Width (optional):"),height:d._("Height (optional):"),insert:d._("Insert")},!0);k.find(".button").click(function(b){var n=k.find("#image").val(),m=k.find("#width").val(),l=k.find("#height").val(),c="";m&&(c+=' width="'+m+'"'),l&&(c+=' height="'+l+'"'),n&&"http://"!==n&&d.wysiwygEditorInsertHtml("<img"+c+' src="'+n+'" />'),d.closeDropDown(!0),b.preventDefault();}),d.createDropDown(e,"insertimage",k);},tooltip:"Insert an image"},email:{exec:function(e){var d=this,k=h("email",{label:d._("E-mail:"),insert:d._("Insert")},!0);k.find(".button").click(function(b){var c=k.find("#email").val();c&&(d.focus(),d.getRangeHelper().selectedHtml()?d.execCommand("createlink","mailto:"+c):d.wysiwygEditorInsertHtml('<a href="mailto:'+c+'">'+c+"</a>")),d.closeDropDown(!0),b.preventDefault();}),d.createDropDown(e,"insertemail",k);},tooltip:"Insert an email"},link:{exec:function(e){var d=this,k=h("link",{url:d._("URL:"),desc:d._("Description (optional):"),ins:d._("Insert")},!0);k.find(".button").click(function(b){var l=k.find("#link").val(),c=k.find("#des").val();l&&"http://"!==l&&(d.focus(),!d.getRangeHelper().selectedHtml()||c?(c||(c=l),d.wysiwygEditorInsertHtml('<a href="'+l+'">'+c+"</a>")):d.execCommand("createlink",l)),d.closeDropDown(!0),b.preventDefault();}),d.createDropDown(e,"insertlink",k);},tooltip:"Insert a link"},unlink:{state:function(){var a=g(this.currentNode());return a.is("a")||a.parents("a").length>0?0:-1;},exec:function(){var a=g(this.currentNode()),d=a.is("a")?a:a.parents("a").first();d.length&&d.replaceWith(d.contents());},tooltip:"Unlink"},quote:{forceNewLineAfter:["blockquote"],exec:function(a,n,m){var l="<blockquote>",k="</blockquote>";n?(m=m?"<cite>"+m+"</cite>":"",l=l+m+n+k,k=null):""===this.getRangeHelper().selectedHtml()&&(k=g.sceditor.ie?"":"<br />"+k),this.wysiwygEditorInsertHtml(l,k);},tooltip:"Insert a Quote"},emoticon:{exec:function(a){var k=this,e=function(s){var r=k.opts.emoticonsCompat,q=k.getRangeHelper(),p=r&&" "!==q.getOuterText(!0,1)?" ":"",o=r&&" "!==q.getOuterText(!1,1)?" ":"",n=g("<div />"),d=g("<div />").appendTo(n),c=g.extend({},k.opts.emoticons.dropdown,s?k.opts.emoticons.more:{}),b=0;return g.each(c,function(){b++;}),b=Math.sqrt(b),g.each(c,function(l,m){d.append(g("<img />").attr({src:m.url||m,alt:l,title:m.tooltip||l}).click(function(){return k.insert(p+g(this).attr("alt")+o,null,!1).closeDropDown(!0),!1;})),d.children().length>=b&&(d=g("<div />").appendTo(n));}),s||n.append(g(k._('<a class="sceditor-more">{0}</a>',k._("More"))).click(function(){return k.createDropDown(a,"more-emoticons",e(!0)),!1;})),n;};k.createDropDown(a,"emoticons",e(!1));},txtExec:function(a){g.sceditor.command.get("emoticon").exec.call(this,a);},tooltip:"Insert an emoticon"},youtube:{_dropDown:function(k,e,n){var m,l=h("youtubeMenu",{label:k._("Video URL:"),insert:k._("Insert")},!0);l.find(".button").click(function(a){var c=l.find("#link").val().replace("http://","");""!==c&&(m=c.match(/(?:v=|v\/|embed\/|youtu.be\/)(.{11})/),m&&(c=m[1]),/^[a-zA-Z0-9_\-]{11}$/.test(c)?n(c):alert("Invalid YouTube video")),k.closeDropDown(!0),a.preventDefault();}),k.createDropDown(e,"insertlink",l);},exec:function(a){var d=this;g.sceditor.command.get("youtube")._dropDown(d,a,function(b){d.wysiwygEditorInsertHtml(h("youtube",{id:b}));});},tooltip:"Insert a YouTube video"},date:{_date:function(l){var k=new Date,o=k.getYear(),n=k.getMonth()+1,m=k.getDate();return 2000>o&&(o=1900+o),10>n&&(n="0"+n),10>m&&(m="0"+m),l.opts.dateFormat.replace(/year/i,o).replace(/month/i,n).replace(/day/i,m);},exec:function(){this.insertText(g.sceditor.command.get("date")._date(this));},txtExec:function(){this.insertText(g.sceditor.command.get("date")._date(this));},tooltip:"Insert current date"},time:{_time:function(){var k=new Date,e=k.getHours(),m=k.getMinutes(),l=k.getSeconds();return 10>e&&(e="0"+e),10>m&&(m="0"+m),10>l&&(l="0"+l),e+":"+m+":"+l;},exec:function(){this.insertText(g.sceditor.command.get("time")._time());},txtExec:function(){this.insertText(g.sceditor.command.get("time")._time());},tooltip:"Insert current time"},ltr:{state:function(d,c){return c&&"ltr"===c.style.direction;},exec:function(){var a=this,k=a.getRangeHelper().getFirstBlockParent(),e=g(k);a.focus(),(k&&!e.is("body")||(a.execCommand("formatBlock","p"),k=a.getRangeHelper().getFirstBlockParent(),e=g(k),k&&!e.is("body")))&&("ltr"===e.css("direction")?e.css("direction",""):e.css("direction","ltr"));},tooltip:"Left-to-Right"},rtl:{state:function(d,c){return c&&"rtl"===c.style.direction;},exec:function(){var a=this,k=a.getRangeHelper().getFirstBlockParent(),e=g(k);a.focus(),(k&&!e.is("body")||(a.execCommand("formatBlock","p"),k=a.getRangeHelper().getFirstBlockParent(),e=g(k),k&&!e.is("body")))&&("rtl"===e.css("direction")?e.css("direction",""):e.css("direction","rtl"));},tooltip:"Right-to-Left"},print:{exec:"print",tooltip:"Print"},maximize:{state:function(){return this.maximize();},exec:function(){this.maximize(!this.maximize());},txtExec:function(){this.maximize(!this.maximize());},tooltip:"Maximize",shortcut:"ctrl+shift+m"},source:{exec:function(){this.toggleSourceMode();},txtExec:function(){this.toggleSourceMode();},tooltip:"View source",shortcut:"ctrl+shift+s"},ignore:{}},g.sceditor.rangeHelper=function(x,w){var v,u,t,s,r,q=!0,p="sceditor-start-marker",o="sceditor-end-marker",n="character",a=this;t=function(d,c){u=c||d.contentDocument||d.document,v=d,q=!!d.getSelection;}(x,w),a.insertHTML=function(k,e){var y,m,l=a.selectedRange();if(e&&(k+=a.selectedHtml()+e),q){for(m=u.createElement("div"),y=u.createDocumentFragment(),m.innerHTML=k;m.firstChild;){y.appendChild(m.firstChild);}a.insertNode(y);}else{if(!l){return !1;}l.pasteHTML(k);}},a.insertNode=function(k,e){if(q){var z,y,m=u.createDocumentFragment(),l=a.selectedRange();if(!l){return !1;}if(m.appendChild(k),e&&(m.appendChild(l.extractContents()),m.appendChild(e)),y=m.lastChild,!y){return;}l.deleteContents(),l.insertNode(m),z=u.createRange(),z.setStartAfter(y),a.selectRange(z);}else{a.insertHTML(k.outerHTML,e?e.outerHTML:null);}},a.cloneSelected=function(){var b=a.selectedRange();return b?q?b.cloneRange():b.duplicate():void 0;},a.selectedRange=function(){var e,d,k=q?v.getSelection():u.selection;if(k){if(k.getRangeAt&&k.rangeCount<=0){for(d=u.body;d.firstChild;){d=d.firstChild;}e=u.createRange(),e.setStart(d,0),k.addRange(e);}return q&&(e=k.getRangeAt(0)),q||"Control"===k.type||(e=k.createRange()),r(e)?e:null;}},r=function(d){var c;return d&&d.parentElement&&(c=d.parentElement())?c.ownerDocument===u:!0;},a.hasSelection=function(){var d,c=q?v.getSelection():u.selection;return q||!c?c&&c.rangeCount>0:(d=c.createRange(),d&&r(d));},a.selectedHtml=function(){var d,c=a.selectedRange();return c?!q&&""!==c.text&&c.htmlText?c.htmlText:q?(d=u.createElement("div"),d.appendChild(c.cloneContents()),d.innerHTML):"":"";},a.parentNode=function(){var b=a.selectedRange();return b?b.parentElement?b.parentElement():b.commonAncestorContainer:void 0;},a.getFirstBlockParent=function(d){var e=function(c){return g.sceditor.dom.isInline(c,!0)?(c=c?c.parentNode:null,c?e(c):null):c;};return e(d||a.parentNode());},a.insertNodeAt=function(k,e){var m=a.selectedRange(),l=a.cloneSelected();return l?(l.collapse(k),l.insertNode?l.insertNode(e):l.pasteHTML(e.outerHTML),a.selectRange(m),void 0):!1;},s=function(d){a.removeMarker(d);var c=u.createElement("span");return c.id=d,c.style.lineHeight="0",c.style.display="none",c.className="sceditor-selection sceditor-ignore",c.innerHTML=" ",c;},a.insertMarkers=function(){a.insertNodeAt(!0,s(p)),a.insertNodeAt(!1,s(o));},a.getMarker=function(b){return u.getElementById(b);},a.removeMarker=function(d){var c=a.getMarker(d);c&&c.parentNode.removeChild(c);},a.removeMarkers=function(){a.removeMarker(p),a.removeMarker(o);},a.saveRange=function(){a.insertMarkers();},a.selectRange=function(b){q?(v.getSelection().removeAllRanges(),v.getSelection().addRange(b)):b.select();},a.restoreRange=function(){var k,e=a.selectedRange(),m=a.getMarker(p),l=a.getMarker(o);return m&&l&&e?(q?(e=u.createRange(),e.setStartBefore(m),e.setEndAfter(l),a.selectRange(e)):(e=u.body.createTextRange(),k=u.body.createTextRange(),k.moveToElementText(m),e.setEndPoint("StartToStart",k),e.moveStart(n,0),k.moveToElementText(l),e.setEndPoint("EndToStart",k),e.moveEnd(n,0),a.selectRange(e)),a.removeMarkers(),void 0):!1;},a.selectOuterText=function(e,d){var k=a.cloneSelected();return k?(k.collapse(!1),q?(k.setStart(k.startContainer,k.startOffset-e),k.setEnd(k.endContainer,k.endOffset+d)):(k.moveStart(n,0-e),k.moveEnd(n,d)),a.selectRange(k),void 0):!1;},a.getOuterText=function(k,e){var m="",l=a.cloneSelected();return l?(l.collapse(!1),k?q?(m=l.startContainer.textContent.substr(0,l.startOffset),m=m.substr(Math.max(0,m.length-e))):(l.moveStart(n,0-e),m=l.text):q?m=l.startContainer.textContent.substr(l.startOffset,e):(l.moveEnd(n,e),m=l.text),m):"";},a.raplaceKeyword=function(L,K,J,I,H,G){J||L.sort(function(d,c){return d.length-c.length;});var F,E,D,C,B,A,z,y=L.length,m=I||L[y-1][0].length;if(H){if(!q){return !1;}++m;}for(F=a.getOuterText(!0,m),E=F+(null!=G?G:""),K&&(E+=a.getOuterText(!1,m));y--;){if(z=L[y][0],B=new RegExp("(?:[\\s    ])"+g.sceditor.regexEscape(z)+"(?=[\\s    ])"),A=F.length-1-z.length,H&&--A,A=Math.max(0,A),(D=H?E.substr(A).search(B):E.indexOf(z,A))>-1){if(H&&(D+=A+1),D>F.length||D+z.length+(H?1:0)<F.length){continue;}return C=F.length-D,a.selectOuterText(C,z.length-C-(null!=G&&/^\S/.test(G)?1:0)),a.insertHTML(L[y][1]),!0;}}return !1;},a.compare=function(d,c){return c||(c=a.selectedRange()),d&&c?q?0===d.compareBoundaryPoints(Range.END_TO_END,c)&&0===d.compareBoundaryPoints(Range.START_TO_START,c):r(d)&&r(c)&&0===d.compareEndPoints("EndToEnd",c)&&0===d.compareEndPoints("StartToStart",c):!d&&!c;};},g.sceditor.dom={traverse:function(l,k,p,o,n){if(l){for(l=n?l.lastChild:l.firstChild;null!=l;){var m=n?l.previousSibling:l.nextSibling;if(!p&&k(l)===!1){return !1;}if(!o&&this.traverse(l,k,p,o,n)===!1){return !1;}if(p&&k(l)===!1){return !1;}l=m;}}},rTraverse:function(k,e,m,l){this.traverse(k,e,m,l,!0);},parseHTML:function(a,l){var k=[],c=(l||j).createElement("div");return c.innerHTML=a,g.merge(k,c.childNodes),k;},hasStyling:function(a){var d=g(a);return a&&(!d.is("p,div")||a.className||d.attr("style")||!g.isEmptyObject(d.data()));},convertElement:function(a,o){for(var n,m,l=a.attributes.length,k=a.ownerDocument.createElement(o);l--;){m=a.attributes[l],(!g.sceditor.ie||m.specified)&&(g.sceditor.ie<8&&/style/i.test(m.name)?a.style.cssText=a.style.cssText:k.setAttribute(m.name,m.value));}for(;n=a.firstChild;){k.appendChild(n);}return a.parentNode.replaceChild(k,a),k;},blockLevelList:"|body|hr|p|div|h1|h2|h3|h4|h5|h6|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|blockquote|center|",isInline:function(a,d){return a&&1===a.nodeType?(a=a.tagName.toLowerCase(),"code"===a?!d:g.sceditor.dom.blockLevelList.indexOf("|"+a+"|")<0):!0;},copyCSS:function(d,c){c.style.cssText=d.style.cssText+c.style.cssText;},fixNesting:function(e){var d=this,k=function(b){for(;d.isInline(b.parentNode,!0);){b=b.parentNode;}return b;};d.traverse(e,function(b){if(1===b.nodeType&&!d.isInline(b,!0)&&d.isInline(b.parentNode,!0)){var n=k(b),m=n.parentNode,l=d.extractContents(n,b),c=b;d.copyCSS(n,c),m.insertBefore(l,n),m.insertBefore(c,n);}});},findCommonAncestor:function(a,d){return g(a).parents().has(g(d)).first();},getSibling:function(a,k){var e;return a?(e=a[k?"previousSibling":"nextSibling"])?e:g.sceditor.dom.getSibling(a.parentNode,k):null;},removeWhiteSpace:function(D,C){for(var B,A,z,y,x,w,v,u,t=g.sceditor.dom.getSibling,s=g.sceditor.dom.isInline,r=D.firstChild,q=/[\t ]+/g,a=/[\t\n\r ]+/g;r;){if(w=r.nextSibling,B=r.nodeValue,A=r.nodeType,1===A&&r.firstChild&&(x=g(r).css("whiteSpace"),/pre(?:\-wrap)?$/i.test(x)||g.sceditor.dom.removeWhiteSpace(r,/line$/i.test(x))),3===A&&B){for(z=t(r),y=t(r,!0),u=y,v=!1;g(u).hasClass("sceditor-ignore");){u=t(u,!0);}if(s(r)&&u){for(;u.lastChild;){u=u.lastChild;}v=3===u.nodeType?/[\t\n\r ]$/.test(u.nodeValue):!s(u);}s(r)&&y&&s(y)&&!v||(B=B.replace(/^[\t\n\r ]+/,"")),s(r)&&z&&s(z)||(B=B.replace(/[\t\n\r ]+$/,"")),B.length?r.nodeValue=B.replace(C?q:a," "):D.removeChild(r);}r=w;}},extractContents:function(l,k){var r=this,q=r.findCommonAncestor(l,k),p=q?q[0]:null,o=!1,n=!1;return function m(b){var a=l.ownerDocument.createDocumentFragment();return r.traverse(b,function(t){if(n||t===k&&o){return n=!0,!1;}t===l&&(o=!0);var s,e;o?jQuery.contains(t,k)&&1===t.nodeType?(s=m(t),e=t.cloneNode(!1),e.appendChild(s),a.appendChild(e)):a.appendChild(t):jQuery.contains(t,l)&&1===t.nodeType&&(s=m(t),e=t.cloneNode(!1),e.appendChild(s),a.appendChild(e));},!1),a;}(p);}},g.sceditor.plugins={},g.sceditor.PluginManager=function(a){var o=this,n=[],m=a,l=function(b){return"signal"+b.charAt(0).toUpperCase()+b.slice(1);},k=function(e,d){e=[].slice.call(e);for(var q=n.length,p=l(e.shift());q--;){if(p in n[q]){if(d){return n[q][p].apply(m,e);}n[q][p].apply(m,e);}}};o.call=function(){k(arguments,!1);},o.callOnlyFirst=function(){return k(arguments,!0);},o.iter=function(b){return b=l(b),function(){var c=n.length;return{callNext:function(d){for(;c--;){if(n[c]&&b in n[c]){return n[c].apply(m,d);}}},hasNext:function(){for(var d=c;d--;){if(n[d]&&b in n[d]){return !0;}}return !1;}};}();},o.hasHandler=function(d){var c=n.length;for(d=l(d);c--;){if(d in n[c]){return !0;}}return !1;},o.exsists=function(c){return c in g.sceditor.plugins?(c=g.sceditor.plugins[c],"function"==typeof c&&"object"==typeof c.prototype):!1;},o.isRegistered=function(c){var d=n.length;if(!o.exsists(c)){return !1;}for(;d--;){if(n[d] instanceof g.sceditor.plugins[c]){return !0;}}return !1;},o.register=function(c){return o.exsists(c)?(c=new g.sceditor.plugins[c],n.push(c),"init" in c&&c.init.apply(m),!0):!1;},o.deregister=function(c){var p,e=n.length,d=!1;if(!o.isRegistered(c)){return !1;}for(;e--;){n[e] instanceof g.sceditor.plugins[c]&&(p=n.splice(e,1)[0],d=!0,"destroy" in p&&p.destroy.apply(m));}return d;},o.destroy=function(){for(var b=n.length;b--;){"destroy" in n[b]&&n[b].destroy.apply(m);}n=null,m=null;};},g.sceditor.command={get:function(a){return g.sceditor.commands[a]||null;},set:function(a,d){return a&&d?(d=g.extend(g.sceditor.commands[a]||{},d),d.remove=function(){g.sceditor.command.remove(a);},g.sceditor.commands[a]=d,this):!1;},remove:function(a){return g.sceditor.commands[a]&&delete g.sceditor.commands[a],this;}},g.sceditor.defaultOptions={toolbar:"bold,italic,underline,strike,subscript,superscript|left,center,right,justify|font,size,color,removeformat|cut,copy,paste,pastetext|bulletlist,orderedlist|table|code,quote|horizontalrule,image,email,link,unlink|emoticon,youtube,date,time|ltr,rtl|print,maximize,source",toolbarExclude:null,style:"jquery.sceditor.default.css",fonts:"Arial,Arial Black,Comic Sans MS,Courier New,Georgia,Impact,Sans-serif,Serif,Times New Roman,Trebuchet MS,Verdana",colors:null,locale:"en",charset:"utf-8",emoticonsCompat:!1,emoticonsEnabled:!0,emoticonsRoot:"",emoticons:{dropdown:{":)":"emoticons/smile.png",":angel:":"emoticons/angel.png",":angry:":"emoticons/angry.png","8-)":"emoticons/cool.png",":'(":"emoticons/cwy.png",":ermm:":"emoticons/ermm.png",":D":"emoticons/grin.png","<3":"emoticons/heart.png",":(":"emoticons/sad.png",":O":"emoticons/shocked.png",":P":"emoticons/tongue.png",";)":"emoticons/wink.png"},more:{":alien:":"emoticons/alien.png",":blink:":"emoticons/blink.png",":blush:":"emoticons/blush.png",":cheerful:":"emoticons/cheerful.png",":devil:":"emoticons/devil.png",":dizzy:":"emoticons/dizzy.png",":getlost:":"emoticons/getlost.png",":happy:":"emoticons/happy.png",":kissing:":"emoticons/kissing.png",":ninja:":"emoticons/ninja.png",":pinch:":"emoticons/pinch.png",":pouty:":"emoticons/pouty.png",":sick:":"emoticons/sick.png",":sideways:":"emoticons/sideways.png",":silly:":"emoticons/silly.png",":sleeping:":"emoticons/sleeping.png",":unsure:":"emoticons/unsure.png",":woot:":"emoticons/w00t.png",":wassat:":"emoticons/wassat.png"},hidden:{":whistling:":"emoticons/whistling.png",":love:":"emoticons/wub.png"}},width:null,height:null,resizeEnabled:!0,resizeMinWidth:null,resizeMinHeight:null,resizeMaxHeight:null,resizeMaxWidth:null,resizeHeight:!0,resizeWidth:!0,getHtmlHandler:null,getTextHandler:null,dateFormat:"year-month-day",toolbarContainer:null,enablePasteFiltering:!1,disablePasting:!1,readOnly:!1,rtl:!1,autofocus:!1,autofocusEnd:!0,autoExpand:!1,autoUpdate:!1,spellcheck:!0,runWithoutWysiwygSupport:!1,id:null,plugins:"",zIndex:null,bbcodeTrim:!1,disableBlockRemove:!1,parserOptions:{},dropDownCss:{}},g.fn.sceditor=function(a){var k,e=[];return a=a||{},a.runWithoutWysiwygSupport||g.sceditor.isWysiwygSupported?(this.each(function(){k=this.jquery?this:g(this),k.parents(".sceditor-container").length>0||("state"===a?e.push(!!k.data("sceditor")):"instance"===a?e.push(k.data("sceditor")):k.data("sceditor")||new g.sceditor(this,a));}),e.length?1===e.length?e[0]:g(e):this):void 0;};}(jQuery,window,document),function(f,e,h){f.sceditor.BBCodeParser=function(L){if(!(this instanceof f.sceditor.BBCodeParser)){return new f.sceditor.BBCodeParser(L);}var K,J,I,H,G,F,E,D,C,B,A,z,y,x,w,v=this,c={open:"open",content:"content",newline:"newline",close:"close"},a=function(j,i,o,n,m,l){var k=this;k.type=j,k.name=i,k.val=o,k.attrs=n||{},k.children=m||[],k.closing=l||null;};a.prototype={clone:function(i){var d=this;return new a(d.type,d.name,d.val,d.attrs,i?d.children:[],d.closing?d.closing.clone():null);},splitAt:function(i){var m,l=this,k=0,j=l.children.length;if("number"!=typeof object&&(i=f.inArray(i,l.children)),0>i||i>j){return null;}for(;j--;){j>=i?k++:j=0;}return m=l.clone(),m.children=l.children.splice(i,k),m;}},K=function(){v.opts=f.extend({},f.sceditor.BBCodeParser.defaults,L),v.bbcodes=f.sceditor.plugins.bbcode.bbcodes;},v.tokenize=function(j){var i,n,m,l=[],k=[{type:"close",regex:/^\[\/[^\[\]]+\]/},{type:"open",regex:/^\[[^\[\]]+\]/},{type:"newline",regex:/^(\r\n|\r|\n)/},{type:"content",regex:/^([^\[\r\n]+|\[)/}];k.reverse();j:for(;j.length;){for(m=k.length;m--;){if(n=k[m].type,(i=j.match(k[m].regex))&&i[0]){l.push(J(n,i[0])),j=j.substr(i[0].length);continue j;}}j.length&&l.push(J(c.content,j)),j="";}return l;},J=function(i,m){var l,k,j;return"open"===i&&(l=m.match(/\[([^\]\s=]+)(?:([^\]]+))?\]/))?(j=x(l[1]),l[2]&&(l[2]=f.trim(l[2]))&&(k=I(l[2]))):"close"===i&&(l=m.match(/\[\/([^\[\]]+)\]/))?j=x(l[1]):"newline"===i&&(j="#newline"),j&&("open"!==i&&"close"!==i||f.sceditor.plugins.bbcode.bbcodes[j])||(i="content",j="#"),new a(i,j,m,k);},I=function(i){var m,l=/([^\s=]+)=(?:(?:(["'])((?:\\\2|[^\2])*?)\2)|((?:.(?!\s\S+=))*.))/g,k=f.sceditor.plugins.bbcode.stripQuotes,j={};if("="===i.charAt(0)&&i.indexOf("=",1)<0){j.defaultattr=k(i.substr(1));}else{for("="===i.charAt(0)&&(i="defaultattr"+i);m=l.exec(i);){j[x(m[1])]=k(m[3])||m[4];}}return j;},v.parse=function(i,d){var j=H(v.tokenize(i));return v.opts.fixInvalidChildren&&C(j),v.opts.removeEmptyTags&&D(j),v.opts.fixInvalidNesting&&F(j),G(j,null,d),v.opts.removeEmptyTags&&D(j),j;},z=function(j,i,l){for(var k=l.length;k--;){if(l[k].type===i&&l[k].name===j){return !0;}}return !1;},E=function(i,l){var k=i?v.bbcodes[i.name]:null,j=k?k.allowedChildren:null;return v.opts.fixInvalidChildren&&j?j&&f.inArray(l.name||"#",j)<0?!1:!0:!0;},H=function(T){for(var S,R,Q,P,O,N,M,u=[],t=[],s=[],r=function(){return w(s);},q=function(b){r()?r().children.push(b):t.push(b);},o=function(d){return r()&&(R=v.bbcodes[r().name])&&R.closedBy&&f.inArray(d,R.closedBy)>-1;};S=T.shift();){switch(M=T[0],S.type){case c.open:o(S.name)&&s.pop(),q(S),R=v.bbcodes[S.name],R&&R.isSelfClosing||!R.closedBy&&!z(S.name,c.close,T)?R&&R.isSelfClosing||(S.type=c.content):s.push(S);break;case c.close:if(r()&&S.name!==r().name&&o("/"+S.name)&&s.pop(),r()&&S.name===r().name){r().closing=S,s.pop();}else{if(z(S.name,c.open,s)){for(;Q=s.pop();){if(Q.name===S.name){Q.closing=S;break;}P=Q.clone(),u.length>1&&P.children.push(w(u)),u.push(P);}for(q(w(u)),O=u.length;O--;){s.push(u[O]);}u.length=0;}else{S.type=c.content,q(S);}}break;case c.newline:r()&&M&&o((M.type===c.close?"/":"")+M.name)&&(M.type!==c.close||M.name!==r().name)&&(R=v.bbcodes[r().name],R&&R.breakAfter?s.pop():R&&R.isInline===!1&&v.opts.breakAfterBlock&&R.breakAfter!==!1&&s.pop()),q(S);break;default:q(S);}N=S;}return t;},G=function(R,Q,P){var O,N,M,u,t,s,r,q,p=R.length,o=p;for(Q&&(u=v.bbcodes[Q.name]);o--;){if(O=R[o]){if(O.type===c.newline){if(N=o>0?R[o-1]:null,M=p-1>o?R[o+1]:null,q=!1,!P&&u&&u.isSelfClosing!==!0&&(N?s||M||(u.isInline===!1&&v.opts.breakEndBlock&&u.breakEnd!==!1&&(q=!0),u.breakEnd&&(q=!0),s=q):(u.isInline===!1&&v.opts.breakStartBlock&&u.breakStart!==!1&&(q=!0),u.breakStart&&(q=!0))),N&&N.type===c.open&&(t=v.bbcodes[N.name])&&(P?t.isInline===!1&&(q=!0):(t.isInline===!1&&v.opts.breakAfterBlock&&t.breakAfter!==!1&&(q=!0),t.breakAfter&&(q=!0))),!P&&!r&&M&&M.type===c.open&&(t=v.bbcodes[M.name])&&(t.isInline===!1&&v.opts.breakBeforeBlock&&t.breakBefore!==!1&&(q=!0),t.breakBefore&&(q=!0),r=q,q)){R.splice(o,1);continue;}q&&R.splice(o,1),r=!1;}else{O.type===c.open&&G(O.children,O,P);}}}},F=function(N,M,u,t){var s,r,q,p,o,n,i=function(j){var d=v.bbcodes[j.name];return !d||d.isInline!==!1;};for(M=M||[],t=t||N,r=0;r<N.length;r++){if((s=N[r])&&s.type===c.open){if(!i(s)&&u&&(q=w(M),n=q.splitAt(s),o=M.length>1?M[M.length-2].children:t,(p=f.inArray(q,o))>-1)){return n.children.splice(f.inArray(s,n.children),1),o.splice(p+1,0,s,n),void 0;}M.push(s),F(s.children,M,u||i(s),t),M.pop(s);}}},C=function(j,i){for(var m,l,k=j.length;k--;){(m=j[k])&&(E(i,m)||(m.name=null,m.type=c.content,E(i,m)?(l=[k+1,0].concat(m.children),m.closing&&(m.closing.name=null,m.closing.type=c.content,l.push(m.closing)),k+=l.length-1,Array.prototype.splice.apply(j,l)):i.children.splice(k,1)),m.type===c.open&&C(m.children,m));}},D=function(i){var m,l,k,j=i.length;for(k=function(n){for(var d=n.length;d--;){if(n[d].type===c.open){return !1;}if(n[d].type===c.close){return !1;}if(n[d].type===c.content&&n[d].val&&/\S|\u00A0/.test(n[d].val)){return !1;}}return !0;};j--;){(m=i[j])&&m.type===c.open&&(l=v.bbcodes[m.name],D(m.children),k(m.children)&&l&&!l.isSelfClosing&&!l.allowsEmpty&&i.splice.apply(i,f.merge([j,1],m.children)));}},v.toHTML=function(i,d){return B(v.parse(i,d),!0);},B=function(O,N){var M,u,t,s,r,q,p,o,m=[];for(p=function(b){return(!b||("undefined"!=typeof b.isHtmlInline?b.isHtmlInline:b.isInline))!==!1;};O.length>0;){if(M=O.shift()){if(M.type===c.open){o=M.children[M.children.length-1]||{},u=v.bbcodes[M.name],r=N&&p(u),t=B(M.children,!1),u&&u.html?(p(u)||!p(v.bbcodes[o.name])||u.isPreFormatted||u.skipLastLineBreak||f.sceditor.ie||(t+="<br />"),s=f.isFunction(u.html)?u.html.call(v,M,M.attrs,t):f.sceditor.plugins.bbcode.formatString(u.html,t)):s=M.val+t+(M.closing?M.closing.val:"");}else{if(M.type===c.newline){if(!N){m.push("<br />");continue;}q||(m.push("<div>"),(h.documentMode&&h.documentMode<8||f.sceditor.ie<8)&&m.push(" ")),f.sceditor.ie||m.push("<br />"),O.length||m.push("<br />"),m.push("</div>\n"),q=!1;continue;}r=N,s=f.sceditor.escapeEntities(M.val);}r&&!q?(m.push("<div>"),q=!0):!r&&q&&(m.push("</div>\n"),q=!1),m.push(s);}}return q&&m.push("</div>\n"),m.join("");},v.toBBCode=function(i,d){return A(v.parse(i,d));},A=function(P){for(var O,N,M,u,t,s,r,q,p,o,n=[];P.length>0;){if(O=P.shift()){if(M=v.bbcodes[O.name],u=!(!M||M.isInline!==!1),t=M&&M.isSelfClosing,r=u&&v.opts.breakBeforeBlock&&M.breakBefore!==!1||M&&M.breakBefore,q=u&&!t&&v.opts.breakStartBlock&&M.breakStart!==!1||M&&M.breakStart,p=u&&v.opts.breakEndBlock&&M.breakEnd!==!1||M&&M.breakEnd,o=u&&v.opts.breakAfterBlock&&M.breakAfter!==!1||M&&M.breakAfter,s=(M?M.quoteType:null)||v.opts.quoteType||f.sceditor.BBCodeParser.QuoteType.auto,M||O.type!==c.open){if(O.type===c.open){if(r&&n.push("\n"),n.push("["+O.name),O.attrs){O.attrs.defaultattr&&(n.push("="+y(O.attrs.defaultattr,s,"defaultattr")),delete O.attrs.defaultattr);for(N in O.attrs){O.attrs.hasOwnProperty(N)&&n.push(" "+N+"="+y(O.attrs[N],s,N));}}n.push("]"),q&&n.push("\n"),O.children&&n.push(A(O.children)),t||M.excludeClosing||(p&&n.push("\n"),n.push("[/"+O.name+"]")),o&&n.push("\n"),O.closing&&t&&n.push(O.closing.val);}else{n.push(O.val);}}else{n.push(O.val),O.children&&n.push(A(O.children)),O.closing&&n.push(O.closing.val);}}}return n.join("");},y=function(i,m,l){var k=f.sceditor.BBCodeParser.QuoteType,j=/\s|=/.test(i);return f.isFunction(m)?m(i,l):m===k.never||m===k.auto&&!j?i:'"'+i.replace("\\","\\\\").replace('"','\\"')+'"';},w=function(b){return b.length?b[b.length-1]:null;},x=function(b){return b.toLowerCase();},K();},f.sceditor.BBCodeParser.QuoteType={always:1,never:2,auto:3},f.sceditor.BBCodeParser.defaults={breakBeforeBlock:!1,breakStartBlock:!1,breakEndBlock:!1,breakAfterBlock:!0,removeEmptyTags:!0,fixInvalidNesting:!0,fixInvalidChildren:!0,quoteType:f.sceditor.BBCodeParser.QuoteType.auto},f.sceditorBBCodePlugin=f.sceditor.plugins.bbcode=function(){var x,w,v,u,t,s,r,q=this;u=f.sceditor.plugins.bbcode.formatString,q.bbcodes=f.sceditor.plugins.bbcode.bbcodes,q.stripQuotes=f.sceditor.plugins.bbcode.stripQuotes;var p={},o={},c={ul:["li","ol","ul"],ol:["li","ol","ul"],table:["tr"],tr:["td","th"],code:["br","p","div"]},a={};q.init=function(){q.opts=this.opts,x(),s(this),this.toBBCode=q.signalToSource,this.fromBBCode=q.signalToWysiwyg;},s=function(i){var k=f.sceditor.command.get,j={bold:{txtExec:["[b]","[/b]"]},italic:{txtExec:["[i]","[/i]"]},underline:{txtExec:["[u]","[/u]"]},strike:{txtExec:["[s]","[/s]"]},subscript:{txtExec:["[sub]","[/sub]"]},superscript:{txtExec:["[sup]","[/sup]"]},left:{txtExec:["[left]","[/left]"]},center:{txtExec:["[center]","[/center]"]},right:{txtExec:["[right]","[/right]"]},justify:{txtExec:["[justify]","[/justify]"]},font:{txtExec:function(l){var d=this;k("font")._dropDown(d,l,function(b){d.insertText("[font="+b+"]","[/font]");});}},size:{txtExec:function(l){var d=this;k("size")._dropDown(d,l,function(b){d.insertText("[size="+b+"]","[/size]");});}},color:{txtExec:function(l){var d=this;k("color")._dropDown(d,l,function(b){d.insertText("[color="+b+"]","[/color]");});}},bulletlist:{txtExec:function(m,l){var b="";f.each(l.split(/\r?\n/),function(){b+=(b?"\n":"")+"[li]"+this+"[/li]";}),i.insertText("[ul]\n"+b+"\n[/ul]");}},orderedlist:{txtExec:function(m,l){var b="";f.each(l.split(/\r?\n/),function(){b+=(b?"\n":"")+"[li]"+this+"[/li]";}),f.sceditor.plugins.bbcode.bbcode.get(""),i.insertText("[ol]\n"+b+"\n[/ol]");}},table:{txtExec:["[table][tr][td]","[/td][/tr][/table]"]},horizontalrule:{txtExec:["[hr]"]},code:{txtExec:["[code]","[/code]"]},image:{txtExec:function(l,d){var m=prompt(this._("Enter the image URL:"),d);m&&this.insertText("[img]"+m+"[/img]");}},email:{txtExec:function(m,l){var z=l&&l.indexOf("@")>-1?null:l,y=prompt(this._("Enter the e-mail address:"),z?"":l),n=prompt(this._("Enter the displayed text:"),z||y)||y;y&&this.insertText("[email="+y+"]"+n+"[/email]");}},link:{txtExec:function(m,l){var z=l&&l.indexOf("http://")>-1?null:l,y=prompt(this._("Enter URL:"),z?"http://":l),n=prompt(this._("Enter the displayed text:"),z||y)||y;y&&this.insertText("[url="+y+"]"+n+"[/url]");}},quote:{txtExec:["[quote]","[/quote]"]},youtube:{txtExec:function(l){var d=this;k("youtube")._dropDown(d,l,function(b){d.insertText("[youtube]"+b+"[/youtube]");});}},rtl:{txtExec:["[rtl]","[/rtl]"]},ltr:{txtExec:["[ltr]","[/ltr]"]}};i.commands=f.extend(!0,{},j,i.commands);},x=function(){f.each(q.bbcodes,function(d){q.bbcodes[d].tags&&f.each(q.bbcodes[d].tags,function(b,j){var i=q.bbcodes[d].isInline===!1;p[b]=p[b]||{},p[b][i]=p[b][i]||{},p[b][i][d]=j;}),q.bbcodes[d].styles&&f.each(q.bbcodes[d].styles,function(b,j){var i=q.bbcodes[d].isInline===!1;o[i]=o[i]||{},o[i][b]=o[i][b]||{},o[i][b][d]=j;});});},t=function(j,A){var z,y,n,m,l,k=j.style;return k?(a[A]||(a[A]=f.camelCase(A)),l=a[A],"text-align"===A?(z=f(j),n=k.direction,m=k[l]||z.css(A),z.parent().css(A)===m||"block"!==z.css("display")||z.is("hr")||z.is("th")||(y=m),n&&y&&(/right/i.test(y)&&"rtl"===n||/left/i.test(y)&&"ltr"===n)?null:y):k[l]):null;},w=function(i,l,k){var j;return k=!!k,o[k]?(f.each(o[k],function(m,b){j=t(i[0],m),j&&t(i.parent()[0],m)!==j&&f.each(b,function(y,n){(!n||f.inArray(j.toString(),n)>-1)&&(l=f.isFunction(q.bbcodes[y].format)?q.bbcodes[y].format.call(q,i,l):u(q.bbcodes[y].format,l));});}),l):l;},v=function(F,E,D){var C,B=F[0],A=B.nodeName.toLowerCase();if(D=!!D,p[A]&&p[A][D]&&f.each(p[A][D],function(i,b){(!b||(C=!1,f.each(b,function(m,l){return !F.attr(m)||l&&f.inArray(F.attr(m),l)<0?void 0:(C=!0,!1);}),C))&&(E=f.isFunction(q.bbcodes[i].format)?q.bbcodes[i].format.call(q,F,E):u(q.bbcodes[i].format,E));}),D&&(!f.sceditor.dom.isInline(B,!0)||"br"===A)){for(var z=B.parentNode,y=z.lastChild,k=B.previousSibling,j=f.sceditor.dom.isInline(z,!0);k&&f(k).hasClass("sceditor-ignore");){k=k.previousSibling;}for(;f(y).hasClass("sceditor-ignore");){y=y.previousSibling;}(j||y!==B||"li"===A||"br"===A&&f.sceditor.ie)&&(E+="\n"),"br"!==A&&k&&"br"!==k.nodeName.toLowerCase()&&f.sceditor.dom.isInline(k,!0)&&(E="\n"+E);}return E;},q.signalToSource=function(i,m){var l,k,j=new f.sceditor.BBCodeParser(q.opts.parserOptions);return m||("string"==typeof i?(l=f("<div />").css("visibility","hidden").appendTo(h.body).html(i),m=l):m=f(i)),m&&m.jquery?(f.sceditor.dom.removeWhiteSpace(m[0]),k=q.elementToBbcode(m),l&&l.remove(),k=j.toBBCode(k,!0),q.opts.bbcodeTrim&&(k=f.trim(k)),k):"";},q.elementToBbcode=function(d){return function i(j,l){var k="";return f.sceditor.dom.traverse(j,function(m){var C=f(m),B="",A=m.nodeType,z=m.nodeName.toLowerCase(),y=c[z],E=m.firstChild,D=!0;if("object"==typeof l&&(D=f.inArray(z,l)>-1,C.is("img")&&C.data("sceditor-emoticon")&&(D=!0),D||(y=l)),3===A||1===A){if(1===A){if(C.hasClass("sceditor-ignore")){return;}if(C.hasClass("sceditor-nlf")&&(!E||!f.sceditor.ie&&1===m.childNodes.length&&/br/i.test(E.nodeName))){return;}"iframe"!==z&&(B=i(m,y)),D?("code"!==z&&(B=w(C,B),B=v(C,B),B=w(C,B,!0)),k+=v(C,B,!0)):k+=B;}else{!m.wholeText||m.previousSibling&&3===m.previousSibling.nodeType?m.wholeText||(k+=m.nodeValue):k+=0===C.parents("code").length?m.wholeText.replace(/ +/g," "):m.wholeText;}}},!1,!0),k;}(d[0]);},q.signalToWysiwyg=function(i,l){var k=new f.sceditor.BBCodeParser(q.opts.parserOptions),j=k.toHTML(q.opts.bbcodeTrim?f.trim(i):i);return l?r(j):j;},r=function(i){var n,m,l,k=f("<div />").hide().appendTo(h.body),j=k[0];return l=function(y,A){if(!f.sceditor.dom.hasStyling(y)){if(f.sceditor.ie||1!==y.childNodes.length||!f(y.firstChild).is("br")){for(;m=y.firstChild;){j.insertBefore(m,y);}}if(A){var z=j.lastChild;y!==z&&f(z).is("div")&&y.nextSibling===z&&j.insertBefore(h.createElement("br"),y);}j.removeChild(y);}},j.innerHTML=i.replace(/<\/div>\n/g,"</div>"),(n=j.firstChild)&&f(n).is("div")&&l(n,!0),(n=j.lastChild)&&f(n).is("div")&&l(n),j=j.innerHTML,k.remove(),j;};},f.sceditor.plugins.bbcode.stripQuotes=function(b){return b?b.replace(/\\(.)/g,"$1").replace(/^(["'])(.*?)\1$/,"$2"):b;},f.sceditor.plugins.bbcode.formatString=function(){var b=arguments;return b[0].replace(/\{(\d+)\}/g,function(a,d){return"undefined"!=typeof b[d-0+1]?b[d-0+1]:"{"+d+"}";});};var g=f.sceditor.plugins.bbcode.normaliseColour=function(i){var d,j;return j=function(b){return b=parseInt(b,10),isNaN(b)?"00":(b=Math.max(0,Math.min(b,255)).toString(16),b.length<2?"0"+b:b);},i=i||"#000",(d=i.match(/rgb\((\d{1,3}),\s*?(\d{1,3}),\s*?(\d{1,3})\)/i))?"#"+j(d[1])+j(d[2]-0)+j(d[3]-0):(d=i.match(/#([0-f])([0-f])([0-f])\s*?$/i))?"#"+d[1]+d[1]+d[2]+d[2]+d[3]+d[3]:i;};f.sceditor.plugins.bbcode.bbcodes={b:{tags:{b:null,strong:null},styles:{"font-weight":["bold","bolder","401","700","800","900"]},format:"[b]{0}[/b]",html:"<strong>{0}</strong>"},i:{tags:{i:null,em:null},styles:{"font-style":["italic","oblique"]},format:"[i]{0}[/i]",html:"<em>{0}</em>"},u:{tags:{u:null},styles:{"text-decoration":["underline"]},format:"[u]{0}[/u]",html:"<u>{0}</u>"},s:{tags:{s:null,strike:null},styles:{"text-decoration":["line-through"]},format:"[s]{0}[/s]",html:"<s>{0}</s>"},sub:{tags:{sub:null},format:"[sub]{0}[/sub]",html:"<sub>{0}</sub>"},sup:{tags:{sup:null},format:"[sup]{0}[/sup]",html:"<sup>{0}</sup>"},font:{tags:{font:{face:null}},styles:{"font-family":null},quoteType:f.sceditor.BBCodeParser.QuoteType.never,format:function(i,d){var j;return"font"===i[0].nodeName.toLowerCase()&&(j=i.attr("face"))||(j=i.css("font-family")),"[font="+this.stripQuotes(j)+"]"+d+"[/font]";},html:function(i,d,j){return'<font face="'+d.defaultattr+'">'+j+"</font>";}},size:{tags:{font:{size:null}},styles:{"font-size":null},format:function(j,i){var l=j.attr("size"),k=1;return l||(l=j.css("fontSize")),l.indexOf("px")>-1?(l=l.replace("px","")-0,l>12&&(k=2),l>15&&(k=3),l>17&&(k=4),l>23&&(k=5),l>31&&(k=6),l>47&&(k=7)):k=l,"[size="+k+"]"+i+"[/size]";},html:function(i,d,j){return'<font size="'+d.defaultattr+'">'+j+"</font>";}},color:{tags:{font:{color:null}},styles:{color:null},quoteType:f.sceditor.BBCodeParser.QuoteType.never,format:function(i,d){var k,j=i[0];return"font"===j.nodeName.toLowerCase()&&(k=i.attr("color"))||(k=j.style.color||i.css("color")),"[color="+g(k)+"]"+d+"[/color]";},html:function(i,d,j){return'<font color="'+g(d.defaultattr)+'">'+j+"</font>";}},ul:{tags:{ul:null},breakStart:!0,isInline:!1,skipLastLineBreak:!0,format:"[ul]{0}[/ul]",html:"<ul>{0}</ul>"},list:{breakStart:!0,isInline:!1,skipLastLineBreak:!0,html:"<ul>{0}</ul>"},ol:{tags:{ol:null},breakStart:!0,isInline:!1,skipLastLineBreak:!0,format:"[ol]{0}[/ol]",html:"<ol>{0}</ol>"},li:{tags:{li:null},isInline:!1,closedBy:["/ul","/ol","/list","*","li"],format:"[li]{0}[/li]",html:"<li>{0}</li>"},"*":{isInline:!1,closedBy:["/ul","/ol","/list","*","li"],html:"<li>{0}</li>"},table:{tags:{table:null},isInline:!1,isHtmlInline:!0,skipLastLineBreak:!0,format:"[table]{0}[/table]",html:"<table>{0}</table>"},tr:{tags:{tr:null},isInline:!1,skipLastLineBreak:!0,format:"[tr]{0}[/tr]",html:"<tr>{0}</tr>"},th:{tags:{th:null},allowsEmpty:!0,isInline:!1,format:"[th]{0}[/th]",html:"<th>{0}</th>"},td:{tags:{td:null},allowsEmpty:!0,isInline:!1,format:"[td]{0}[/td]",html:"<td>{0}</td>"},emoticon:{allowsEmpty:!0,tags:{img:{src:null,"data-sceditor-emoticon":null}},format:function(d,c){return d.data("sceditor-emoticon")+c;},html:"{0}"},hr:{tags:{hr:null},allowsEmpty:!0,isSelfClosing:!0,isInline:!1,format:"[hr]{0}",html:"<hr />"},img:{allowsEmpty:!0,tags:{img:{src:null}},quoteType:f.sceditor.BBCodeParser.QuoteType.never,format:function(j,i){var o,n,m="",l=j[0],k=function(b){return l.style?l.style[b]:null;};return j.attr("data-sceditor-emoticon")?i:(o=j.attr("width")||k("width"),n=j.attr("height")||k("height"),(l.complete&&(o||n)||o&&n)&&(m="="+j.width()+"x"+j.height()),"[img"+m+"]"+j.attr("src")+"[/img]");},html:function(j,i,m){var l,k="";return"undefined"!=typeof i.width&&(k+=' width="'+i.width+'"'),"undefined"!=typeof i.height&&(k+=' height="'+i.height+'"'),i.defaultattr&&(l=i.defaultattr.split(/x/i),k=' width="'+l[0]+'" height="'+(2===l.length?l[1]:l[0])+'"'),"<img"+k+' src="'+m+'" />';}},url:{allowsEmpty:!0,tags:{a:{href:null}},quoteType:f.sceditor.BBCodeParser.QuoteType.never,format:function(i,d){var j=i.attr("href");return"mailto:"===j.substr(0,7)?'[email="'+j.substr(7)+'"]'+d+"[/email]":"[url="+decodeURI(j)+"]"+d+"[/url]";},html:function(i,d,j){return'<a href="'+encodeURI(d.defaultattr||j)+'">'+j+"</a>";}},email:{quoteType:f.sceditor.BBCodeParser.QuoteType.never,html:function(i,d,j){return'<a href="mailto:'+(d.defaultattr||j)+'">'+j+"</a>";}},quote:{tags:{blockquote:null},isInline:!1,quoteType:f.sceditor.BBCodeParser.QuoteType.never,format:function(a,l){var k="",j=f(a),i=j.children("cite").first();return(1===i.length||j.data("author"))&&(k=i.text()||j.data("author"),j.data("author",k),i.remove(),l=this.elementToBbcode(f(a)),k="="+k,j.prepend(i)),"[quote"+k+"]"+l+"[/quote]";},html:function(i,d,j){return d.defaultattr&&(j="<cite>"+d.defaultattr+"</cite>"+j),"<blockquote>"+j+"</blockquote>";}},code:{tags:{code:null},isInline:!1,allowedChildren:["#","#newline"],format:"[code]{0}[/code]",html:"<code>{0}</code>"},left:{styles:{"text-align":["left","-webkit-left","-moz-left","-khtml-left"]},isInline:!1,format:"[left]{0}[/left]",html:'<div align="left">{0}</div>'},center:{styles:{"text-align":["center","-webkit-center","-moz-center","-khtml-center"]},isInline:!1,format:"[center]{0}[/center]",html:'<div align="center">{0}</div>'},right:{styles:{"text-align":["right","-webkit-right","-moz-right","-khtml-right"]},isInline:!1,format:"[right]{0}[/right]",html:'<div align="right">{0}</div>'},justify:{styles:{"text-align":["justify","-webkit-justify","-moz-justify","-khtml-justify"]},isInline:!1,format:"[justify]{0}[/justify]",html:'<div align="justify">{0}</div>'},youtube:{allowsEmpty:!0,tags:{iframe:{"data-youtube-id":null}},format:function(d,c){return d=d.attr("data-youtube-id"),d?"[youtube]"+d+"[/youtube]":c;},html:'<iframe width="560" height="315" src="http://www.youtube.com/embed/{0}?wmode=opaque" data-youtube-id="{0}" frameborder="0" allowfullscreen></iframe>'},rtl:{styles:{direction:["rtl"]},format:"[rtl]{0}[/rtl]",html:'<div style="direction: rtl">{0}</div>'},ltr:{styles:{direction:["ltr"]},format:"[ltr]{0}[/ltr]",html:'<div style="direction: ltr">{0}</div>'},ignore:{}},f.sceditor.plugins.bbcode.bbcode={get:function(a){return f.sceditor.plugins.bbcode.bbcodes[a]||null;},set:function(a,d){return a&&d?(d=f.extend(f.sceditor.plugins.bbcode.bbcodes[a]||{},d),d.remove=function(){f.sceditor.plugins.bbcode.bbcode.remove(a);},f.sceditor.plugins.bbcode.bbcodes[a]=d,this):!1;},rename:function(d,c){return this.hasOwnProperty(d)?(this[c]=this[d],this.remove(d),this):!1;},remove:function(a){return f.sceditor.plugins.bbcode.bbcodes[a]&&delete f.sceditor.plugins.bbcode.bbcodes[a],this;}},f.fn.sceditorBBCodePlugin=function(a){return a=a||{},f.isPlainObject(a)&&(a.plugins=(a.plugins?a.plugins:"")+"bbcode"),this.sceditor(a);};}(jQuery,window,document);
