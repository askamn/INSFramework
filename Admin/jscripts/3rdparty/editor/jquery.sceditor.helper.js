window.clickableEditor={};jQuery(document).ready(function($){$.sceditor.plugins.bbcode.bbcode.set("align",{html:function(element,attrs,content){return'<div align="'+(attrs.defaultattr||'left')+'">'+ content+'</div>';},isInline:false}).set("center",{format:"[align=center]{0}[/align]"}).set("left",{format:"[align=left]{0}[/align]"}).set("right",{format:"[align=right]{0}[/align]"}).set("justify",{format:"[align=justify]{0}[/align]"});$.sceditor.command.set("center",{txtExec:["[align=center]","[/align]"]}).set("left",{txtExec:["[align=left]","[/align]"]}).set("right",{txtExec:["[align=right]","[/align]"]}).set("justify",{txtExec:["[align=justify]","[/align]"]});$.sceditor.plugins.bbcode.bbcode.set("list",{html:function(element,attrs,content){var type=(attrs.defaultattr==='1'?'ol':'ul');if(attrs.defaultattr==='a')
type='ol type="a"';return'<'+ type+'>'+ content+'</'+ type+'>';},isInline:false,skipLastLineBreak:true}).set("ul",{format:"[list]{0}[/list]",isInline:false,skipLastLineBreak:true}).set("ol",{format:function($elm,content){var type=($elm.attr('type')==='a'?'a':'1');return'[list='+ type+']'+ content+'[/list]';},isInline:false,skipLastLineBreak:true}).set("li",{format:"[*]{0}",excludeClosing:true}).set("*",{excludeClosing:true,isInline:false});$.sceditor.command.set("bulletlist",{txtExec:["[list]\n[*]","\n[/list]"],isInline:false,skipLastLineBreak:true}).set("orderedlist",{txtExec:["[list=1]\n[*]","\n[/list]"],isInline:false,skipLastLineBreak:true});$.sceditor.plugins.bbcode.bbcode.set("h1",{tags:{h1:null},format:"[h1]{0}[/h1]",html:"<h1>{0}</h1>",isInline:false,skipLastLineBreak:true}).set("h2",{tags:{h2:null},format:"[h2]{0}[/h2]",html:"<h2>{0}</h2>",isInline:false,skipLastLineBreak:true}).set("h3",{tags:{h3:null},format:"[h3]{0}[/h3]",html:"<h3>{0}</h3>",isInline:false,skipLastLineBreak:true}).set("h4",{tags:{h4:null},format:"[h4]{0}[/h4]",html:"<h4>{0}</h4>",isInline:false,skipLastLineBreak:true}).set("h5",{tags:{h5:null},format:"[h5]{0}[/h5]",html:"<h5>{0}</h5>",isInline:false,skipLastLineBreak:true}).set("h6",{tags:{h6:null},format:"[h6]{0}[/h6]",html:"<h6>{0}</h6>",isInline:false,skipLastLineBreak:true});$.sceditor.command.set("headers",{createDropdown:function(editor,callback){var $content=$("<div />");for(var i=1;i<=6;i++){$('<a class="sceditor-header-option" href="#">'+'<h'+ i+'>Heading '+ i+'</h'+ i+'>'+'</a>').data('headersize',i).click(function(e){callback($(this).data('headersize'));editor.closeDropDown(true);e.preventDefault();}).appendTo($content);}
return $content;},exec:function(caller){var editor=this;var $content=$.sceditor.command.get("headers").createDropdown(editor,function(size){editor.execCommand("formatblock","<h"+ size+">");});editor.createDropDown(caller,"header-picker",$content);},txtExec:function(caller){var editor=this;var $content=$.sceditor.command.get("headers").createDropdown(editor,function(size){editor.insert('[h'+ size+']','[/h'+ size+']');});editor.createDropDown(caller,"header-picker",$content);},tooltip:"Format Headers"});$.sceditor.plugins.bbcode.bbcode.set('indent',{isInline:false,styles:{"margin-left":null},format:function($elm,content){var count='',indent=(parseInt($elm.css('marginLeft'))||0);if(indent<30)
return content;if(indent>=60)
count='='+ Math.round(indent/30);return'[indent'+ count+']'+ content+'[/indent]';},html:function(token,attrs,content){var margin='30px',indent=(parseInt(attrs.defaultattr)||0);if(indent)
margin=(indent*30)+'px';return'<div style="margin-left: '+ margin+'">'+ content+'</div>';}});$.sceditor.command.set('indent',{state:function(parents,firstBlock){return firstBlock&&!!firstBlock.style.marginLeft;},exec:function(){var editor=this,elm=editor.getRangeHelper().getFirstBlockParent(),$elm=$(elm);editor.focus();if(!elm||$elm.is('body'))
{editor.execCommand("formatBlock","p");elm=editor.getRangeHelper().getFirstBlockParent();$elm=$(elm);if(!elm||$elm.is('body'))
return;}
if($elm.is('li')||$elm.parents('li:first').length)
editor.execCommand("indent");else
$elm.css('marginLeft',(parseInt($elm.css('marginLeft'))||0)+ 30);},tooltip:"Indent"});$.sceditor.command.set('outdent',{state:function(parents,firstBlock){return firstBlock&&!!firstBlock.style.marginLeft;},exec:function(){var indent,editor=this,elm=editor.getRangeHelper().getFirstBlockParent(),$elm=$(elm);editor.focus();if(!elm||$elm.is('body'))
{editor.execCommand("formatBlock","p");elm=editor.getRangeHelper().getFirstBlockParent();$elm=$(elm);if(!elm||$elm.is('body'))
return;}
if($elm.is('li')||$elm.parents('li:first').length)
editor.execCommand("outdent");else if((indent=parseInt($elm.css('marginLeft')))>0)
$elm.css('marginLeft',indent>30?indent- 30:0);},tooltip:"Outdent"});$.sceditor.plugins.bbcode.bbcode.set('size',{format:function($elm,content){var fontSize,sizes=['xx-small','x-small','small','medium','large','x-large','xx-large'],size=$elm.data('scefontsize');if(!size){fontSize=$elm.css('fontSize');if(fontSize.indexOf("px")>-1){fontSize=fontSize.replace("px","")- 0;size=1;if(fontSize>9)
size=2;if(fontSize>12)
size=3;if(fontSize>15)
size=4;if(fontSize>17)
size=5;if(fontSize>23)
size=6;if(fontSize>31)
size=7;}else
size=(~~fontSize)+ 1;if(size>7)
size=7;if(size<1)
size=1;size=sizes[size- 1];}
return'[size='+ size+']'+ content+'[/size]';},html:function(token,attrs,content){return'<span data-scefontsize="'+ attrs.defaultattr+'" style="font-size:'+ attrs.defaultattr+'">'+ content+'</span>';}});$.sceditor.command.set('size',{_dropDown:function(editor,caller,callback){var content=$("<div />"),clickFunc=function(e){callback($(this).data('size'));editor.closeDropDown(true);e.preventDefault();};for(var i=1;i<7;i++)
content.append($('<a class="sceditor-fontsize-option" data-size="'+ i+'" href="#"><font size="'+ i+'">'+ i+'</font></a>').click(clickFunc));editor.createDropDown(caller,"fontsize-picker",content);},txtExec:function(caller){var editor=this,sizes=['xx-small','x-small','small','medium','large','x-large','xx-large'];$.sceditor.command.get('size')._dropDown(editor,caller,function(size){size=(~~size);size=(size>7)?7:((size<1)?1:size);editor.insertText("[size="+ sizes[size]+"]","[/size]");});}});$.sceditor.plugins.bbcode.bbcode.set("quote",{format:function(element,content){var attribs='',$elm=$(element);if($elm.data('name')){attribs='='+ $elm.data('name');$elm.children('.partebassa').first().remove();}
if($elm.data('pid'))
attribs+=" pid='"+ $elm.data('pid')+"'";if($elm.data('dateline'))
attribs+=" dateline='"+ $elm.data('dateline')+"'";if($elm.data('avatar')){attribs+=" avatar='"+ $elm.data('avatar')+"'";$elm.children('.avatar').first().remove();}
content=this.elementToBbcode($elm);return'[quote'+ attribs+']'+ content+'[/quote]';},html:function(token,attrs,content){var data='',author='',avatar='',date='',partebassa='',extra='';if(attrs.pid)
data+=' data-pid="'+ attrs.pid+'"';if(attrs.defaultattr){data+=' data-name="'+ attrs.defaultattr+'"';author=attrs.defaultattr;}
if(attrs.dateline){data+=' data-dateline="'+ attrs.dateline+'"';relClock=relativeClock.prototype.convert;now=Math.floor(Date.now()/1000);date=relClock(now,attrs.dateline);}
if(attrs.avatar){data+=' data-avatar="'+ attrs.avatar+'"';avatar+='<img src="'+ attrs.avatar+'" class="avatar" />';}
if(date&&author||avatar){if(date&&author){extra=', '+ date;}
partebassa='<div class="partebassa"><span>Inviato da '+ author+ extra+'</span></div>';data+=' class="idlMessaggio-citazione"';content='<div>'+ content+'</div>';}
return'<blockquote '+ data+'>'+ avatar+ content+ partebassa+'</blockquote>';},quoteType:function(val,name){return"'"+ val.replace("'","\\'")+"'";}});$.sceditor.plugins.bbcode.bbcode.set("font",{format:function(element,content){var font;if(element[0].nodeName.toLowerCase()!=="font"||!(font=element.attr('face')))
font=element.css('font-family');if(sceditor_opts.limitfont)
font=font.split(',')[0];return'[font='+ this.stripQuotes(font)+']'+ content+'[/font]';}});$.sceditor.command.remove('table');$.sceditor.plugins.bbcode.bbcode.remove('table').remove('tr').remove('th').remove('td');var editorColors='#fff,#003649,#004d65,#006d8f,#008cb4,#00a2d7,#00c6fc,#59d6fd,#96e4fd,#cbf1fe|#ebebeb,#001a57,#00297a,#003ba9,#004ed6,#0056fe,#3c82fd,#75a4fe,#a8c4fe,#d4e2fe|#d6d6d6,#10003b,#1a0052,#2b0076,#360094,#4c00b3,#5c00eb,#853afd,#b085fd,#d8c7fe|#c0c0c0,#2d003e,#440059,#60007c,#79009e,#9700bd,#bc00f3,#d141fd,#e18afe,#f0c6fe|#aaa,#3b031b,#550a29,#77103e,#98184f,#b7205d,#e42b7a,#eb6a9e,#f2a0c0,#f8d1e0|#929292,#5b0000,#810300,#b30600,#e00b00,#ff3417,#fe5b51,#ff8982,#ffb3af,#fedad8|#7a7a7a,#591a00,#7a2700,#ab3a00,#d74c00,#ff6606,#fe8348,#fea47d,#ffc4ab,#ffe2d6|#606060,#573400,#794900,#a86800,#d38400,#fdaa00,#fdb440,#fec777,#fedaa9,#ffedd5|#474747,#553e00,#775800,#a67c00,#d19e00,#fdc900,#fdcc40,#feda77,#fee5a9,#fff2d5|#2e2e2e,#666300,#8d8800,#c4bf00,#f5ef00,#ffff42,#fffa6c,#fffb95,#fffdb9,#fefddd|#171717,#4f5703,#6f780a,#9ba811,#c4d41a,#daef39,#e4f266,#ebf590,#f2f9b8,#f8fbdb|#000,#273f0f,#39591a,#507c28,#689f35,#79bf41,#98d660,#b2e08c,#cdeab5,#e0eed4';toolbar="bold,italic,underline,strike,subscript,superscript|left,center,right,justify|emoticon,youtube,headers,indent,outdent|color,removeformat,bulletlist,orderedlist|code,quote,image,link,unlink,source";width=853;if(typeof signature!=='undefined'){toolbar="bold,italic,underline,strike,color|left,center,right,justify,emoticon|removeformat,image,link,unlink,source";width='100%';}
$("#message, #signature, #signature_new").sceditor({style:"jscripts/sceditor/jquery.sceditor.mybb.css",toolbar:toolbar,width:width,height:300,resizeMaxHeight:600,resizeWidth:false,autoExpand:true,plugins:'bbcode',toolbarContainer:'#topSpace',autofocus:sceditor_opts.autofocus,locale:sceditor_opts.lang,rtl:null,emoticons:sceditor_opts.emoticons,enablePasteFiltering:true,autofocusEnd:true,colors:editorColors,});$(document).on("focus",'textarea[id*="quickedit_"]',function(){var container=$(this).attr("id");$(this).sceditor({style:"jscripts/sceditor/jquery.sceditor.mybb.css",toolbar:toolbar,width:width,height:50,resizeMaxHeight:600,resizeWidth:false,autoExpand:true,plugins:'bbcode',toolbarContainer:'#'+ container+'_editor',autofocus:sceditor_opts.autofocus,locale:sceditor_opts.lang,rtl:null,emoticons:sceditor_opts.emoticons,enablePasteFiltering:true,autofocusEnd:true,colors:editorColors,});});if(sceditor_opts.sourcemode){$('#message, #signature, #signature_new, textarea[id*="quickedit_"]').sceditor("instance").sourceMode(true);}
$("#clickable_smilies img").each(function(){$(this).css('cursor','pointer');$(this).click(function(){$("#message, #signature, #signature_new").data("sceditor").insert($(this).attr('alt'));return false;});});var $checkbox=$("input[name=postoptions\\[disablesmilies\\]], input[name=options\\[disablesmilies\\]]");$checkbox.change(function(){$("#message, #signature, #signature_new").sceditor("instance").emoticons(!this.checked);});if($checkbox.length)
$("#message, #signature, #signature_new").sceditor("instance").emoticons(!$checkbox[0].checked);clickableEditor.insertAttachment=function(aid){$("#message, #signature, #signature_new").data("sceditor").insertText('[attachment='+ aid+']');};clickableEditor.performInsert=function(code){$("#message, #signature, #signature_new").data("sceditor").insert(code);};clickableEditor.openGetMoreSmilies=function(editor){MyBB.popupWindow('misc.php?action=smilies&popup=true&editor='+ editor,'sminsert',240,280);};var textarea=$("#message, #signature, #signature_new").get(0);if(textarea){$(textarea.form).bind("reset",function(){$("#message, #signature, #signature_new").data("sceditor").val("").emoticons(true);});}});if(typeof Thread!=="undefined"){var quickReplyFunc=Thread.quickReply;Thread.quickReply=function(e){var editor=jQuery("#message, #signature, #signature_new").data("sceditor");if(editor)
editor.updateOriginal();return quickReplyFunc.call(Thread,e);};Thread.quickEditLoaded=function(request,pid){if(request.responseText.match(/<error>(.*)<\/error>/)){message=request.responseText.match(/<error>(.*)<\/error>/);if(!message[1]){message[1]="An unknown error occurred.";}
if(this.spinner){this.spinner.destroy();this.spinner='';}
alert('There was an error performing the update.\n\n'+ message[1]);Thread.qeCache[pid]="";}else if(request.responseText){$("pid_"+ pid).innerHTML=request.responseText;element=jQuery("#quickedit_"+ pid);offset=element.offset().top- 100;element.focus();jQuery("html, body").animate({scrollTop:offset},700,'easeInOutQuint');}
if(this.spinner){this.spinner.destroy();this.spinner='';}};var quickEditSaveFunc=Thread.quickEditSave;Thread.quickEditSave=function(pid){var editor=jQuery("#quickedit_"+ pid).data("sceditor");if(editor)
editor.updateOriginal();return quickEditSaveFunc.call(Thread,pid);};Thread.multiQuotedLoaded=function(request){if(request.responseText.match(/<error>(.*)<\/error>/)){message=request.responseText.match(/<error>(.*)<\/error>/);if(!message[1])
message[1]="An unknown error occurred.";if(this.spinner){this.spinner.destroy();this.spinner='';}
alert('There was an error fetching the posts.\n\n'+ message[1]);}else if(request.responseText){var editor=jQuery("#message, #signature, #signature_new").data("sceditor");if(editor)
editor.insert(request.responseText);}
Thread.clearMultiQuoted();$('quickreply_multiquote').hide();$('quoted_ids').value='all';if(this.spinner){this.spinner.destroy();this.spinner='';}};}